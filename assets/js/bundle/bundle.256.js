"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[256],{756:(e,t,a)=>{a.d(t,{A:()=>v});var n=a(3029),r=a(2901),l=a(4441),o=a(3954),s=a(5501),c=a(4467),i=a(6540),u=a(1820),m=a(7886);function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(d=function(){return!!e})()}function p(e){var t,a,n;return{name:(null===(t=e.rule)||void 0===t?void 0:t.name)||"",contains:(null===(a=e.rule)||void 0===a?void 0:a.contains)||"",tag:(null===(n=e.rule)||void 0===n?void 0:n.tag)||""}}var v=function(e){function t(e){var a,r,s,u;return(0,n.A)(this,t),r=this,s=t,u=[e],s=(0,o.A)(s),a=(0,l.A)(r,d()?Reflect.construct(s,u||[],(0,o.A)(r).constructor):s.apply(r,u)),(0,c.A)(a,"handleChange",(function(e){a.setState((0,c.A)({},e.target.name,e.target.value))})),(0,c.A)(a,"handleSubmit",(function(e){var t;e.preventDefault();var n=a.state,r=n.name,l=n.contains,o=n.tag;m.A.upsert({_id:(null===(t=a.props.rule)||void 0===t?void 0:t._id)||null,name:r,contains:l,tag:o}).then((function(e){return a.props.onSave(e)}))})),(0,c.A)(a,"onSubmitClick",(function(){a.formRef.current&&a.formRef.current.requestSubmit()})),a.state=p(e),a.formRef=i.createRef(),a}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidUpdate",value:function(e){e.rule!==this.props.rule&&this.setState(p(this.props))}},{key:"getModalTitle",value:function(){var e;return null!==(e=this.props.rule)&&void 0!==e&&e._id?"Edit Rule":"Add Rule"}},{key:"getModalBody",value:function(){var e=this.state,t=e.name,a=e.contains,n=e.tag;return i.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Name"),i.createElement("input",{type:"text",className:"form-control",name:"name",value:t,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Contains"),i.createElement("textarea",{className:"form-control",name:"contains",value:a,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Tag"),i.createElement("input",{type:"text",className:"form-control",name:"tag",value:n,onChange:this.handleChange,required:!0})))}},{key:"render",value:function(){return i.createElement(u.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(i.Component)},3256:(e,t,a)=>{a.d(t,{A:()=>N});var n=a(3029),r=a(2901),l=a(4441),o=a(3954),s=a(5501),c=a(4467),i=a(6540),u=a(5474),m=a(2543);function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(d=function(){return!!e})()}var p=function(e){function t(){return(0,n.A)(this,t),e=this,a=t,r=arguments,a=(0,o.A)(a),(0,l.A)(e,d()?Reflect.construct(a,r||[],(0,o.A)(e).constructor):a.apply(e,r));var e,a,r}return(0,s.A)(t,e),(0,r.A)(t,[{key:"render",value:function(){var e=this.props.transactions,t=m.groupBy(e,"transactionType"),a=m.sumBy(t.DEBIT,(function(e){return e[u.zU]})),n=m.sumBy(t.CREDIT,(function(e){return e[u.zU]}));return i.createElement("div",{className:"mt-4"},i.createElement("table",{className:"table table-bordered"},i.createElement("thead",{className:"table-dark"},i.createElement("tr",null,i.createElement("th",null,"Total Debits"),i.createElement("th",null,"Total Credits"))),i.createElement("tbody",null,i.createElement("tr",null,i.createElement("td",null,a),i.createElement("td",null,n)))))}}])}(i.Component),v=a(8573),f=a(7886),h=a(756),g=a(1820);function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}function A(e){var t,a,n,r;return{date:(null===(t=e.transaction)||void 0===t?void 0:t.date)||"",description:(null===(a=e.transaction)||void 0===a?void 0:a.description)||"",transactionType:(null===(n=e.transaction)||void 0===n?void 0:n.transactionType)||"",amount:(null===(r=e.transaction)||void 0===r?void 0:r.amount)||0}}var y=function(e){function t(e){var a,r,s,u;return(0,n.A)(this,t),r=this,s=t,u=[e],s=(0,o.A)(s),a=(0,l.A)(r,E()?Reflect.construct(s,u||[],(0,o.A)(r).constructor):s.apply(r,u)),(0,c.A)(a,"handleChange",(function(e){a.setState((0,c.A)({},e.target.name,e.target.value))})),(0,c.A)(a,"handleSubmit",(function(e){var t;e.preventDefault();var n=a.state,r=n.date,l=n.description,o=n.transactionType,s=n.amount;a.props.onSave({_id:(null===(t=a.props.transaction)||void 0===t?void 0:t._id)||null,date:r,description:l,transactionType:o,amount:parseFloat(s)},a.props.transactionIndex)})),(0,c.A)(a,"onSubmitClick",(function(){a.formRef.current&&a.formRef.current.requestSubmit()})),a.state=A(e),a.formRef=i.createRef(),a}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidUpdate",value:function(e){e.transaction!==this.props.transaction&&this.setState(A(this.props))}},{key:"getModalTitle",value:function(){return this.props.transaction?"Edit Transaction":"Add Transaction"}},{key:"getModalBody",value:function(){var e=this.state,t=e.date,a=e.description,n=e.transactionType,r=e.amount;return i.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Date"),i.createElement("input",{type:"text",className:"form-control",name:"date",value:t,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Transaction Type"),i.createElement("select",{className:"form-select",name:"transactionType",value:n,onChange:this.handleChange,required:!0},i.createElement("option",{value:"DEBIT"},"Debit"),i.createElement("option",{value:"CREDIT"},"Credit"))),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Amount"),i.createElement("input",{type:"number",className:"form-control",name:"amount",value:r,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Description"),i.createElement("input",{type:"text",className:"form-control",name:"description",value:a,onChange:this.handleChange})))}},{key:"render",value:function(){return i.createElement(g.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(i.Component),b=a(8736),T=a(2543);function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var N=function(e){function t(){var e,a,r,s;(0,n.A)(this,t);for(var m=arguments.length,d=new Array(m),p=0;p<m;p++)d[p]=arguments[p];return a=this,r=t,s=[].concat(d),r=(0,o.A)(r),e=(0,l.A)(a,C()?Reflect.construct(r,s||[],(0,o.A)(a).constructor):r.apply(a,s)),(0,c.A)(e,"state",{filteredTransactions:[],startDateFilter:null,endDateFilter:null,transactionTypeFilter:null,tagFilter:null,showRulesModal:!1,showTransactionModal:!1,selectedTransactionIndex:null,getAccountsLoadingStatus:!1,accounts:[],getRulesLoadingStatus:!1,rulesMap:{},selectedAccount:""}),(0,c.A)(e,"applyRules",(function(e,t){return e.forEach((function(e){t.forEach((function(t){var a=t._id,n=t.contains;a in e.appliedRules||e.description.toLowerCase().includes(n.toLowerCase())&&(e.appliedRules[a]=1)}))})),e})),(0,c.A)(e,"updateTransaction",(function(t,a){e.props.transactions[a]=T.assign(e.props.transactions[a],t),e.applyRules([e.props.transactions[a]],T.values(e.state.rulesMap)),e.forceUpdate()})),(0,c.A)(e,"updateRule",(function(t){e.state.rulesMap[t._id]=t,e.applyRules(e.props.transactions,[t]),e.forceUpdate()})),(0,c.A)(e,"toggleRulesModal",(function(t){e.setState({showRulesModal:!e.state.showRulesModal,selectedTransactionIndex:t})})),(0,c.A)(e,"handleRuleSave",(function(t){e.toggleRulesModal(),e.updateRule(t)})),(0,c.A)(e,"toggleTransactionModal",(function(t){e.setState({showTransactionModal:!e.state.showTransactionModal,selectedTransactionIndex:t})})),(0,c.A)(e,"handleTransactionSave",(function(t,a){e.toggleTransactionModal(),e.updateTransaction(t,a)})),(0,c.A)(e,"getTransaction",(function(t,a){if(t)return i.createElement("div",{key:a,className:"col-md-6 col-lg-4 mb-2"},i.createElement("div",{className:"card shadow"},i.createElement("div",{className:"card-body"},e.getTags(t,a),u.Jp.map((function(e){return i.createElement("div",{key:e,className:"mb-1"},i.createElement("strong",null,u.WB[e],":")," ",t[e])})))))})),(0,c.A)(e,"handleFilterChange",(function(t){e.setState((0,c.A)({},t.target.name,t.target.value))})),(0,c.A)(e,"handleAccountChange",(function(t){e.setState({selectedAccount:t.target.value})})),(0,c.A)(e,"bulkSave",(function(){e.props.transactions.forEach((function(t){t.account=e.state.selectedAccount})),b.A.bulkSave(e.props.transactions)})),(0,c.A)(e,"getAccounts",(function(){e.setState({getAccountsLoadingStatus:!0},(function(){v.A.getAll().then((function(t){e.setState({getAccountsLoadingStatus:!1,accounts:t.accounts})}))}))})),(0,c.A)(e,"getRules",(function(){e.setState({getRulesLoadingStatus:!0},(function(){f.A.getAll().then((function(t){e.setState({getRulesLoadingStatus:!1,rulesMap:T.mapValues(T.keyBy(t.rules,"_id")),transactions:e.applyRules(e.props.transactions,t.rules)})}))}))})),e}return(0,s.A)(t,e),(0,r.A)(t,[{key:"getCrudRuleModal",value:function(){var e,t=this,a=this.state,n=a.showRulesModal,r=a.selectedTransactionIndex,l=r>=0?null===(e=this.props.transactions[r])||void 0===e?void 0:e.description:"";return i.createElement(h.A,{show:n,rule:{contains:l},onSave:this.handleRuleSave,onClose:function(){return t.toggleRulesModal()}})}},{key:"getCrudTransactionModal",value:function(){var e=this,t=this.state,a=t.showTransactionModal,n=t.selectedTransactionIndex,r=n>=0?this.props.transactions[n]:null;return i.createElement(y,{show:a,transaction:r,transactionIndex:n,onSave:this.handleTransactionSave,onClose:function(){return e.toggleTransactionModal()}})}},{key:"removeTransactionTag",value:function(e,t,a){e.appliedRules[a]=0,this.updateTransaction(e,t)}},{key:"getDefaultTag",value:function(e,t){return i.createElement("span",{className:"badge bg-"+t+" me-1"},e)}},{key:"getTag",value:function(e,t,a){var n,r=this,l=this.state.rulesMap;return i.createElement("div",{key:a,className:"badge bg-primary me-1"},null===(n=l[a])||void 0===n?void 0:n.tag,i.createElement("span",{className:"ms-1 cursor-pointer",onClick:function(){return r.removeTransactionTag(e,t,a)}},"×"))}},{key:"getTags",value:function(e,t){var a=this,n=T.keys(T.pickBy(e.appliedRules,(function(e){return 1==e})));return i.createElement("div",{className:"row mb-2"},i.createElement("div",{className:"col-8"},this.getDefaultTag(e.transactionType,"CREDIT"==e.transactionType?"success":"warning"),0==n.length&&this.getDefaultTag("Others","dark"),n.map((function(n){return a.getTag(e,t,n)})),i.createElement("span",{className:"badge bg-secondary me-2 cursor-pointer",onClick:function(){return a.toggleRulesModal(t)}},"+")),i.createElement("div",{className:"col-3"},this.getTransactionActions(t)))}},{key:"getTransactionActions",value:function(e){var t=this;return i.createElement("div",{className:"d-flex"},i.createElement("span",{className:"badge bg-warning cursor-pointer me-2",onClick:function(){return t.toggleTransactionModal(e)}},i.createElement("i",{className:"bi bi-pencil"})),i.createElement("span",{className:"badge bg-danger cursor-pointer"},i.createElement("i",{className:"bi bi-trash"})))}},{key:"getTransactions",value:function(){var e=this.props.transactions;return i.createElement("div",{className:"row"},e.map(this.getTransaction))}},{key:"getFilters",value:function(){var e=this.state.rulesMap;return i.createElement("div",{className:"card p-3 shadow"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-3 col-sm-12 mb-2"},i.createElement("div",{className:"fw-bold"},"From"),i.createElement("input",{type:"date",name:"startDateFilter",className:"form-control",onChange:this.handleFilterChange})),i.createElement("div",{className:"col-md-3 col-sm-12 mb-2"},i.createElement("div",{className:"fw-bold"},"To"),i.createElement("input",{type:"date",name:"endDateFilter",className:"form-control",onChange:this.handleFilterChange})),i.createElement("div",{className:"col-md-3 col-sm-12 mb-2"},i.createElement("div",{className:"fw-bold"},"Transaction Type"),i.createElement("select",{name:"transactionTypeFilter",className:"form-control",onChange:this.handleFilterChange},i.createElement("option",{value:""},"All"),i.createElement("option",{value:"DEBIT"},"Debit"),i.createElement("option",{value:"CREDIT"},"Credit"))),i.createElement("div",{className:"col-md-3 col-sm-12 mb-2"},i.createElement("div",{className:"fw-bold"},"Tag"),i.createElement("select",{name:"tagFilter",className:"form-control",onChange:this.handleFilterChange},i.createElement("option",{value:""},"All"),i.createElement("option",{value:"__NONE__"},"Others"),T.values(e).map((function(e,t){return i.createElement("option",{key:t,value:e._id},e.tag)}))))))}},{key:"getFilteredTransactions",value:function(){var e=this;return T.map(this.props.transactions,(function(t){return!T.isEmpty(e.state.startDateFilter)&&t.date<=e.state.startDateFilter||!T.isEmpty(e.state.endDateFilter)&&t.date>=e.state.endDateFilter?null:(T.isEmpty(e.state.transactionTypeFilter)||t.transactionType==e.state.transactionTypeFilter)&&(T.isEmpty(e.state.tagFilter)||"__NONE__"==e.state.tagFilter&&0==T.size(T.pickBy(t.appliedRules,(function(e){return 1==e})))||e.state.tagFilter in t.appliedRules&&1==t.appliedRules[e.state.tagFilter])?t:null}))}},{key:"getBulkSaveCard",value:function(){return i.createElement("div",{className:"card p-3 shadow-lg"},i.createElement("div",{className:"mb-3"},i.createElement("select",{className:"form-select",value:this.state.selectedAccount,onChange:this.handleAccountChange},i.createElement("option",{value:""},"Select Account"),this.state.accounts.map((function(e,t){return i.createElement("option",{key:t,value:e._id},e.name)})))),i.createElement("div",null,i.createElement("button",{className:"btn btn-primary",disabled:T.isEmpty(this.state.selectedAccount)||T.isEmpty(this.props.transactions),onClick:this.bulkSave},"Bulk Save")))}},{key:"render",value:function(){var e=this.getFilteredTransactions();return i.createElement("div",{className:"mt-4 overflow-auto"},this.getFilters(),i.createElement(p,{transactions:e}),i.createElement("div",{className:"row"},e.map(this.getTransaction)),this.getCrudRuleModal(),this.getCrudTransactionModal(),this.props.bulkSave&&this.getBulkSaveCard())}},{key:"componentDidMount",value:function(){this.getAccounts(),this.getRules()}}])}(i.Component)},5474:(e,t,a)=>{a.d(t,{E5:()=>l,Jp:()=>i,Tv:()=>u,WB:()=>c,_Y:()=>o,zU:()=>s});var n=a(4467),r=a(2543),l="681626859343-dtkml0ds42u48qg1q5nr07kevma99tfk.apps.googleusercontent.com",o={bank:"Bank",cash:"Cash",credit_card:"Credit Card"},s="amount",c=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},"date","Date"),"transactionType","Transaction Type"),s,"Amount"),"balance","Balance"),"description","Description"),i=r.keys(c),u={HDFC_AS_XLS_V1:"HDFC - XLS - V1",SBI_AS_XLS_V1:"SBI - XLS - V1",AXIS_AS_PDF_V1:"AXIS - PDF - V1"}},7886:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(1967);const r={getAll:function(){return n.A.get("/api/v1/rules")},upsert:function(e){return n.A.post("/api/v1/rule",e)},delete:function(e){return n.A.delete("/api/v1/rule/".concat(e))}}},8573:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(1967);const r={getAll:function(){return n.A.get("/api/v1/accounts")},upsert:function(e){return n.A.post("/api/v1/account",e)},delete:function(e){return n.A.delete("/api/v1/account/".concat(e))}}},8736:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(1967);const r={extract:function(e,t){var a=new FormData;return a.append("extractor",e),a.append("file",t),n.A.post("/api/v1/transactions/extract",a,{"Content-Type":"multipart/form-data"})},bulkSave:function(e){return n.A.post("/api/v1/transactions/save",{transactions:e})},getAll:function(){return n.A.get("/api/v1/transactions")}}}}]);