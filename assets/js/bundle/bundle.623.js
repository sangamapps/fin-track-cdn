"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[623],{5004:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var n=a(467),c=a(3029),o=a(2901),r=a(4441),s=a(3954),l=a(5501),u=a(4467),i=a(4756),m=a.n(i),d=a(6540),h=a(378),f=a(5474),v=a(7634),p=a(3256),A=a(8573),g=a(8736),E=a(2543);function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var y=function(e){function t(){var e,a,o,l;(0,c.A)(this,t);for(var i=arguments.length,d=new Array(i),v=0;v<i;v++)d[v]=arguments[v];return a=this,o=t,l=[].concat(d),o=(0,s.A)(o),e=(0,r.A)(a,b()?Reflect.construct(o,l||[],(0,s.A)(a).constructor):o.apply(a,l)),(0,u.A)(e,"state",{selectedExtractor:E.keys(f.Tv)[0],selectedFile:null,transactions:[],extractionStatus:!1,extracted:0,selectedAccount:"",accounts:[],showAccountModal:!1}),(0,u.A)(e,"toggleAccountModal",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.state.selectedAccount;e.setState({showAccountModal:!e.state.showAccountModal,selectedAccount:t})})),(0,u.A)(e,"handleExtractorChange",(function(t){e.setState({selectedExtractor:t.target.value,transactions:[],extracted:0})})),(0,u.A)(e,"handleFileUpload",function(){var t=(0,n.A)(m().mark((function t(a){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.target.files[0]){t.next=3;break}return t.abrupt("return",e.setState({selectedFile:null,transactions:[],extracted:0}));case 3:e.setState({selectedFile:n,transactions:[],extracted:0});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,u.A)(e,"getTransactions",(function(){if(!e.state.selectedFile)return h.oR.warn("Please select a file");e.setState({extractionStatus:!0,extracted:0}),g.A.extract(e.state.selectedExtractor,e.state.selectedFile).then((function(t){e.setState({transactions:t.processed_transactions,extractionStatus:!1,extracted:1})})).catch((function(t){e.setState({transactions:[],extractionStatus:!1,extracted:0}),h.oR.error(t.message)}))})),(0,u.A)(e,"updateTransaction",(function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};e.state.transactions[a]=E.assign(e.state.transactions[a],t),n()})),(0,u.A)(e,"deleteTransaction",(function(t,a){e.state.transactions.splice(a,1)})),(0,u.A)(e,"handleAccountChange",(function(t){e.setState({selectedAccount:t.target.value})})),(0,u.A)(e,"bulkSave",(function(){g.A.bulkSave(e.state.selectedAccount,e.state.transactions).then((function(){return h.oR.info("Successfully saved transactions. Can be viewed in View page.")}))})),(0,u.A)(e,"handleAccountSave",(function(t){e.state.accounts.push(t),e.toggleAccountModal(t._id)})),(0,u.A)(e,"getAccounts",(function(){A.A.getAll().then((function(t){return e.setState({accounts:t.accounts})}))})),e}return(0,l.A)(t,e),(0,o.A)(t,[{key:"getUploadCard",value:function(){return d.createElement("div",{className:"p-3 shadow mb-3"},d.createElement("h3",{className:"mb-3"},"Upload Statement"),d.createElement("div",{className:"mb-3"},d.createElement("label",{className:"form-label"},"Select Extractor"),d.createElement("select",{className:"form-select",value:this.state.selectedExtractor,onChange:this.handleExtractorChange},E.keys(f.Tv).map((function(e,t){return d.createElement("option",{key:t,value:e},f.Tv[e])})))),d.createElement("div",{className:"mb-3"},d.createElement("label",{className:"form-label"},"Upload File"),d.createElement("input",{type:"file",className:"form-control",onChange:this.handleFileUpload})),d.createElement("div",null,d.createElement("button",{className:"btn btn-primary",onClick:this.getTransactions},"Extract")))}},{key:"showTransactions",value:function(){var e=this.state.transactions;return 0==e.length?this.state.extractionStatus?d.createElement("div",{className:"mt-4 d-flex justify-content-center"},d.createElement("div",{className:"spinner-border text-primary text-center",role:"status"},d.createElement("span",{className:"visually-hidden"},"Loading..."))):this.state.extracted?d.createElement("div",{className:"mt-4 alert alert-danger"},"No transactions found"):void 0:d.createElement(p.A,{transactions:e,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction})}},{key:"getBulkSaveCard",value:function(){var e=this,t=this.state,a=t.selectedAccount,n=t.accounts,c=t.transactions;if(!E.isEmpty(c))return d.createElement("div",{className:"p-3 shadow-lg"},d.createElement("div",{className:"mb-3 d-flex"},d.createElement("select",{className:"form-select me-2",value:a,onChange:this.handleAccountChange},d.createElement("option",{value:""},"Select Account"),n.map((function(e,t){return d.createElement("option",{key:t,value:e._id},e.name)}))),d.createElement("button",{className:"btn btn-primary",onClick:function(){return e.toggleAccountModal()}},"+")),d.createElement("div",null,d.createElement("button",{className:"btn btn-primary",disabled:E.isEmpty(a),onClick:this.bulkSave},"Bulk Save")))}},{key:"getCrudRuleModal",value:function(){var e=this,t=this.state.showAccountModal;return d.createElement(v.A,{show:t,onSave:this.handleAccountSave,onClose:function(){return e.toggleAccountModal()}})}},{key:"render",value:function(){return d.createElement("div",{className:"mb-3"},this.getUploadCard(),this.showTransactions(),this.getBulkSaveCard(),this.getCrudRuleModal())}},{key:"componentDidMount",value:function(){this.getAccounts()}}])}(d.Component)},7634:(e,t,a)=>{a.d(t,{A:()=>A});var n=a(3029),c=a(2901),o=a(4441),r=a(3954),s=a(5501),l=a(4467),u=a(6540),i=a(378),m=a(448),d=a(8573),h=a(5474),f=a(2543);function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}function p(e){var t,a,n,c;return{accountGroup:(null===(t=e.account)||void 0===t?void 0:t.accountGroup)||"",name:(null===(a=e.account)||void 0===a?void 0:a.name)||"",amount:(null===(n=e.account)||void 0===n?void 0:n.amount)||"",description:(null===(c=e.account)||void 0===c?void 0:c.description)||""}}var A=function(e){function t(e){var a,c,s,m;return(0,n.A)(this,t),c=this,s=t,m=[e],s=(0,r.A)(s),a=(0,o.A)(c,v()?Reflect.construct(s,m||[],(0,r.A)(c).constructor):s.apply(c,m)),(0,l.A)(a,"handleChange",(function(e){a.setState((0,l.A)({},e.target.name,e.target.value))})),(0,l.A)(a,"handleSubmit",(function(e){var t;e.preventDefault();var n=a.state,c=n.accountGroup,o=n.name,r=n.amount,s=n.description;d.A.upsert({_id:(null===(t=a.props.account)||void 0===t?void 0:t._id)||null,accountGroup:c,name:o,amount:parseFloat(r),description:s}).then((function(e){i.oR.info("Account saved successfully"),a.props.onSave(e)}))})),(0,l.A)(a,"onSubmitClick",(function(){a.formRef.current&&a.formRef.current.requestSubmit()})),a.state=p(e),a.formRef=u.createRef(),a}return(0,s.A)(t,e),(0,c.A)(t,[{key:"componentDidUpdate",value:function(e){e.account!==this.props.account&&this.setState(p(this.props))}},{key:"getModalTitle",value:function(){return this.props.account?"Edit Account":"Add Account"}},{key:"getModalBody",value:function(){var e=this.state,t=e.accountGroup,a=e.name,n=e.amount,c=e.description;return u.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Account Group"),u.createElement("select",{className:"form-control",name:"accountGroup",value:t,onChange:this.handleChange,required:!0},u.createElement("option",null),f.keys(h._Y).map((function(e,t){return u.createElement("option",{key:t,value:e},h._Y[e])})))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Name"),u.createElement("input",{type:"text",className:"form-control",name:"name",value:a,onChange:this.handleChange,required:!0})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Amount"),u.createElement("input",{type:"number",className:"form-control",name:"amount",value:n,onChange:this.handleChange})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Description"),u.createElement("textarea",{className:"form-control",name:"description",value:c,onChange:this.handleChange})))}},{key:"render",value:function(){return u.createElement(m.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(u.Component)}}]);