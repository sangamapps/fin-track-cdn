"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[718],{448:(e,t,a)=>{a.d(t,{A:()=>m});var n=a(3029),r=a(2901),l=a(4441),o=a(3954),s=a(5501),c=a(6540),i=a(6634);function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}var m=function(e){function t(){return(0,n.A)(this,t),e=this,a=t,r=arguments,a=(0,o.A)(a),(0,l.A)(e,u()?Reflect.construct(a,r||[],(0,o.A)(e).constructor):a.apply(e,r));var e,a,r}return(0,s.A)(t,e),(0,r.A)(t,[{key:"getModalTitle",value:function(){return c.createElement("h5",{className:"modal-title"},this.props.title)}},{key:"getCloseButton",value:function(){return c.createElement("button",{type:"button",className:"btn-close",onClick:this.props.onClose})}},{key:"getModalHeader",value:function(){return c.createElement("div",{className:"modal-header"},this.getModalTitle(),this.getCloseButton())}},{key:"getModalBody",value:function(){var e=this.props.body;return e&&c.createElement("div",{className:"modal-body"},e)}},{key:"getCancelButton",value:function(){return c.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.props.onClose},"Cancel")}},{key:"getSubmitButton",value:function(){return c.createElement("button",{type:"submit",className:"btn btn-dark",onClick:this.props.onSubmitClick},"Submit")}},{key:"getModalFooter",value:function(){return c.createElement("div",{className:"modal-footer"},this.getCancelButton(),this.getSubmitButton())}},{key:"render",value:function(){return c.createElement(i.A,{in:this.props.show,timeout:490,classNames:"modal-container",unmountOnExit:!0},c.createElement("div",null,c.createElement("div",{className:"modal-backdrop fade show"}),c.createElement("div",{className:"modal fade show d-block"},c.createElement("div",{className:"modal-dialog"},c.createElement("div",{className:"modal-content"},this.getModalHeader(),this.getModalBody(),this.getModalFooter())))))}}])}(c.Component)},756:(e,t,a)=>{a.d(t,{A:()=>v});var n=a(3029),r=a(2901),l=a(4441),o=a(3954),s=a(5501),c=a(4467),i=a(6540),u=a(1225),m=a(378),d=a(448),p=a(3908);function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function h(e){var t,a,n,r;return{_id:(null===(t=e.rule)||void 0===t?void 0:t._id)||"",tag:(null===(a=e.rule)||void 0===a?void 0:a.tag)||"",keywords:(null===(n=e.rule)||void 0===n?void 0:n.keywords)||"",description:(null===(r=e.rule)||void 0===r?void 0:r.description)||""}}var g=function(e){function t(e){var a,r,s,u;return(0,n.A)(this,t),r=this,s=t,u=[e],s=(0,o.A)(s),a=(0,l.A)(r,f()?Reflect.construct(s,u||[],(0,o.A)(r).constructor):s.apply(r,u)),(0,c.A)(a,"handleChange",(function(e){a.setState((0,c.A)({},e.target.name,e.target.value))})),(0,c.A)(a,"handleSubmit",(function(e){e.preventDefault(),a.state.tag=a.state.tag||a.state.name,a.props.dispatch((0,p.Pv)(a.state)).then((function(e){m.oR.info("Rule saved ✅"),(a.props.onSave||a.props.onClose||function(){})(e.payload)}))})),(0,c.A)(a,"onSubmitClick",(function(){a.formRef.current&&a.formRef.current.requestSubmit()})),a.state=h(e),a.formRef=i.createRef(),a}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidUpdate",value:function(e){e.rule!==this.props.rule&&this.setState(h(this.props))}},{key:"getModalTitle",value:function(){var e;return null!==(e=this.props.rule)&&void 0!==e&&e._id?"Edit Rule":"Add Rule"}},{key:"getModalBody",value:function(){var e=this.state,t=e.name,a=e.keywords,n=e.tag;return i.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Tag"),i.createElement("input",{type:"text",className:"form-control",name:"tag",value:n||t,onChange:this.handleChange,placeholder:"Tag",required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Keywords"),i.createElement("textarea",{className:"form-control",name:"keywords",value:a,onChange:this.handleChange,placeholder:"Keywords (eg: Keyword1, Keyword2)",required:!0})))}},{key:"render",value:function(){return i.createElement(d.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(i.Component);const v=(0,u.Ng)()(g)},5370:(e,t,a)=>{a.d(t,{A:()=>n});const n={getFormattedAmount:function(e){return e.toLocaleString("en-IN",{minimumFractionDigits:2})}}},5474:(e,t,a)=>{a.d(t,{$7:()=>s,E5:()=>n,Z0:()=>r,t2:()=>o,tP:()=>l,wc:()=>c});var n="681626859343-dtkml0ds42u48qg1q5nr07kevma99tfk.apps.googleusercontent.com",r={bank:"Bank",cash:"Cash",credit_card:"Credit Card",stocks:"Stocks",nonmonetary:"Non-Monetary",others:"Others"},l={DATE:"Date",ACCOUNT:"Account",TYPE:"Transaction Type",AMOUNT:"Amount",DESCRIPTION:"Description",COMMENTS:"Comments"},o={DEBIT:"DEBIT",CREDIT:"CREDIT"},s={DEBIT:"Debit",CREDIT:"Credit"},c={HDFC_AS_XLS_V1:"HDFC - XLS - V1",SBI_AS_XLS_V1:"SBI - XLS - V1",AXIS_AS_PDF_V1:"AXIS - PDF - V1"}},8736:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(4297);const r={extract:function(e,t,a){var r=new FormData;return r.append("accountId",e),r.append("extractor",t),r.append("file",a),n.A.post("/api/v1/transactions/extract",r,{"Content-Type":"multipart/form-data"})},saveDrafts:function(){return n.A.post("/api/v1/transactions/save-drafts")},deleteDrafts:function(){return n.A.post("/api/v1/transactions/delete-drafts")},getAll:function(e,t,a,r){return n.A.get("/api/v1/transactions",{startDate:e,endDate:t,isDraft:a,sortByDate:r})},upsert:function(e){return n.A.post("/api/v1/transaction",e)},delete:function(e){return n.A.delete("/api/v1/transaction/".concat(e))}}},8846:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(5474);const r={getTransactionTypeLabel:function(e){return n.$7[e]},getAccountLabel:function(e){return e.name+" ("+n.Z0[e.type]+")"}}},9718:(e,t,a)=>{a.r(t),a.d(t,{default:()=>re});var n=a(5458),r=a(3029),l=a(2901),o=a(4441),s=a(3954),c=a(5501),i=a(4467),u=a(6540),m=a(1225),d=a(378),p=a(8736),f=a(5474),h=a(8846),g=a(2543);function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var b=function(e){function t(){var e,a,n,l;(0,r.A)(this,t);for(var c=arguments.length,m=new Array(c),d=0;d<c;d++)m[d]=arguments[d];return a=this,n=t,l=[].concat(m),n=(0,s.A)(n),e=(0,o.A)(a,v()?Reflect.construct(n,l||[],(0,s.A)(a).constructor):n.apply(a,l)),(0,i.A)(e,"state",{showFiltersView:!1}),(0,i.A)(e,"handleFilterChange",(function(t){e.props.handleFilterChange(t.target.name,t.target.value)})),(0,i.A)(e,"getDateFilter",(function(){var t=e.props.filters;return u.createElement("div",{className:"mb-2"},u.createElement("div",{className:"input-group m-0"},u.createElement("span",{className:"input-group-text"},"From"),u.createElement("input",{type:"date",name:"startDateFilter",value:t.startDateFilter,className:"form-control",onChange:e.handleFilterChange}),u.createElement("span",{className:"input-group-text"},"To"),u.createElement("input",{type:"date",name:"endDateFilter",value:t.endDateFilter,className:"form-control",onChange:e.handleFilterChange}),u.createElement("button",{className:"btn btn-dark",onClick:function(){return e.props.resetDateFilter("startDateFilter","")}},u.createElement("i",{className:"bi bi-trash-fill"}))))})),e}return(0,c.A)(t,e),(0,l.A)(t,[{key:"toggleFiltersView",value:function(){this.setState({showFiltersView:!this.state.showFiltersView})}},{key:"getFilters",value:function(){var e=this;if(!this.state.showFiltersView)return this.getFiltersButton();var t=this.props,a=t.accountsMap,n=t.rulesMap,r=t.filters;return u.createElement("div",{className:"p-3 bg-dark rounded-end-1",style:{maxWidth:"500px"}},u.createElement("div",{className:"row"},u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Min"),u.createElement("input",{type:"number",name:"minAmountFilter",value:r.minAmountFilter,className:"form-control",onChange:this.handleFilterChange}),u.createElement("span",{className:"input-group-text"},"Max"),u.createElement("input",{type:"number",name:"maxAmountFilter",value:r.maxAmountFilter,className:"form-control",onChange:this.handleFilterChange}))),a&&u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Account Type"),u.createElement("select",{name:"accountTypeFilter",value:r.accountTypeFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),g.keys(g.groupBy(this.props.accountsMap,"type")).map((function(e,t){return u.createElement("option",{key:t,value:e},f.Z0[e])}))))),a&&u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Account"),u.createElement("select",{name:"accountIdFilter",value:r.accountIdFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),g.values(this.props.accountsMap).map((function(e,t){return u.createElement("option",{key:t,value:e._id},h.A.getAccountLabel(e))}))))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Transaction Type"),u.createElement("select",{name:"transactionTypeFilter",value:r.transactionTypeFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),u.createElement("option",{value:f.t2.DEBIT},"Debit"),u.createElement("option",{value:f.t2.CREDIT},"Credit")))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Tag"),u.createElement("select",{name:"tagFilter",value:r.tagFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),u.createElement("option",{value:"__NONE__"},"Others"),g.values(n).map((function(e,t){return u.createElement("option",{key:t,value:e._id},e.tag)}))))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Include in Totals"),u.createElement("select",{name:"excludeFromTotalsFilter",value:r.excludeFromTotalsFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),u.createElement("option",{value:"0"},"Only Included"),u.createElement("option",{value:"1"},"Only Excluded")))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Search"),u.createElement("input",{type:"search",name:"searchFilter",value:r.searchFilter,className:"form-control",onChange:this.handleFilterChange})))),u.createElement("button",{className:"btn btn-secondary me-2",onClick:function(){return e.toggleFiltersView()}},u.createElement("i",{className:"bi bi-x-lg"})),u.createElement("button",{className:"btn btn-secondary me-2",onClick:this.props.resetFilters},u.createElement("i",{className:"bi bi-trash-fill"})))}},{key:"getFiltersButton",value:function(){var e=this;return u.createElement("button",{className:"btn btn-dark rounded-circle m-2",onClick:function(){return e.toggleFiltersView()},style:{width:"50px",height:"50px"}},u.createElement("i",{className:"bi bi-funnel-fill"}))}},{key:"render",value:function(){return u.createElement("div",{className:""},this.getDateFilter(),u.createElement("div",{className:"position-fixed z-1 bottom-0 start-0"},this.getFilters()))}}])}(u.Component);const y=(0,m.Ng)((function(e){return g.pick(e.user,["accountsMap","rulesMap"])}))(b);var E=a(5370),A=a(2543);function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}var N=function(e){function t(){return(0,r.A)(this,t),e=this,a=t,n=arguments,a=(0,s.A)(a),(0,o.A)(e,T()?Reflect.construct(a,n||[],(0,s.A)(e).constructor):a.apply(e,n));var e,a,n}return(0,c.A)(t,e),(0,l.A)(t,[{key:"render",value:function(){var e=this.props,t=e.transactions,a=e.accounts;if(A.isEmpty(t)||A.isEmpty(a))return u.createElement(u.Fragment,null);var n=A.uniq(t.map((function(e){return e.accountId}))),r=a.filter((function(e){return n.includes(e._id||e.id)&&!e.type.includes("others")})).map((function(e){var a=e._id||e.id,n=e.openingBalance||0,r=t.filter((function(e){return e.accountId===a})),l=A.groupBy(r,"type"),o=A.sumBy(l[f.t2.DEBIT],(function(e){return e.amount})),s=A.sumBy(l[f.t2.CREDIT],(function(e){return e.amount})),c=n+s-o;return{name:e.name,type:e.type,openingBalance:n,totalDebit:o,totalCredit:s,closingBalance:c}})),l={openingBalance:A.sumBy(r,"openingBalance"),totalDebit:A.sumBy(r,"totalDebit"),totalCredit:A.sumBy(r,"totalCredit")};return l.closingBalance=l.openingBalance+l.totalCredit-l.totalDebit,u.createElement("div",{className:"mt-4"},u.createElement("h4",{className:"mb-3"},"Summary"),u.createElement("div",{className:"table-responsive"},u.createElement("table",{className:"table table-bordered table-striped text-center shadow-sm"},u.createElement("thead",{className:"table-light"},u.createElement("tr",null,u.createElement("th",null,"Account"),u.createElement("th",null,"Opening Balance (₹)"),u.createElement("th",null,"Total Debit (₹)"),u.createElement("th",null,"Total Credit (₹)"),u.createElement("th",null,"Closing Balance (₹)"))),u.createElement("tbody",null,r.map((function(e,t){return u.createElement("tr",{key:t},u.createElement("td",null,h.A.getAccountLabel(e)),u.createElement("td",{className:"text-muted"},E.A.getFormattedAmount(e.openingBalance)),u.createElement("td",{className:"text-danger"},E.A.getFormattedAmount(e.totalDebit)),u.createElement("td",{className:"text-success"},E.A.getFormattedAmount(e.totalCredit)),u.createElement("td",{className:"fw-bold"},E.A.getFormattedAmount(e.closingBalance)))})),u.createElement("tr",{className:"table-secondary fw-bold"},u.createElement("td",null,"Total"),u.createElement("td",null,E.A.getFormattedAmount(l.openingBalance)),u.createElement("td",null,E.A.getFormattedAmount(l.totalDebit)),u.createElement("td",null,E.A.getFormattedAmount(l.totalCredit)),u.createElement("td",null,E.A.getFormattedAmount(l.closingBalance)))))))}}])}(u.Component),C=a(756),F=a(448),D=a(5093),k=a(2543);function B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(B=function(){return!!e})()}function x(e){var t,a,n,r,l,o,s,c,i,u;return{_id:(null===(t=e.transaction)||void 0===t?void 0:t._id)||"",date:(null===(a=e.transaction)||void 0===a?void 0:a.date)||D().format("YYYY-MM-DD"),type:(null===(n=e.transaction)||void 0===n?void 0:n.type)||f.t2.DEBIT,accountId:(null===(r=e.transaction)||void 0===r?void 0:r.accountId)||"",amount:(null===(l=e.transaction)||void 0===l?void 0:l.amount)||0,excludeFromTotals:(null===(o=e.transaction)||void 0===o?void 0:o.excludeFromTotals)||0,balance:(null===(s=e.transaction)||void 0===s?void 0:s.balance)||0,description:(null===(c=e.transaction)||void 0===c?void 0:c.description)||"",appliedRules:(null===(i=e.transaction)||void 0===i?void 0:i.appliedRules)||{},comments:(null===(u=e.transaction)||void 0===u?void 0:u.comments)||"",isDraft:e.isDraft}}var w=function(e){function t(e){var a,n,l,c;return(0,r.A)(this,t),n=this,l=t,c=[e],l=(0,s.A)(l),a=(0,o.A)(n,B()?Reflect.construct(l,c||[],(0,s.A)(n).constructor):l.apply(n,c)),(0,i.A)(a,"handleChange",(function(e){a.setState((0,i.A)({},e.target.name,e.target.value))})),(0,i.A)(a,"handleSubmit",(function(e){e.preventDefault(),a.state.amount=parseFloat(a.state.amount),a.state.excludeFromTotals=parseInt(a.state.excludeFromTotals),p.A.upsert(a.state).then((function(e){d.oR.info("Transaction saved ✅"),a.props.onSave(e.transaction)}))})),(0,i.A)(a,"onSubmitClick",(function(){a.formRef.current&&a.formRef.current.requestSubmit()})),a.state=x(e),a.formRef=u.createRef(),a}return(0,c.A)(t,e),(0,l.A)(t,[{key:"componentDidUpdate",value:function(e){e.transaction!==this.props.transaction&&this.setState(x(this.props))}},{key:"getModalTitle",value:function(){return this.props.transaction?"Edit Transaction":"Add Transaction"}},{key:"getModalBody",value:function(){var e=this.state,t=e.date,a=e.description,n=e.accountId,r=e.type,l=e.amount,o=e.excludeFromTotals,s=e.comments,c=this.props.accountsMap;return u.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Date"),u.createElement("input",{type:"date",className:"form-control",name:"date",value:t,onChange:this.handleChange,required:!0})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Transaction Type"),u.createElement("select",{className:"form-select",name:"type",value:r,onChange:this.handleChange,required:!0},u.createElement("option",{value:""}),u.createElement("option",{value:"DEBIT"},"Debit"),u.createElement("option",{value:"CREDIT"},"Credit"))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Account"),u.createElement("select",{className:"form-select",name:"accountId",value:n,onChange:this.handleChange,required:!0},u.createElement("option",{value:""}),k.values(c).map((function(e,t){return u.createElement("option",{key:t,value:e._id},h.A.getAccountLabel(e))})))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Amount"),u.createElement("input",{type:"number",className:"form-control",name:"amount",value:l,onChange:this.handleChange,required:!0})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Exclude from Totals"),u.createElement("select",{className:"form-select",name:"excludeFromTotals",value:o,onChange:this.handleChange,required:!0},u.createElement("option",{value:"0"},"No"),u.createElement("option",{value:"1"},"Yes"))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Description"),u.createElement("input",{type:"text",className:"form-control",name:"description",value:a,onChange:this.handleChange})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Comments"),u.createElement("textarea",{className:"form-control",name:"comments",value:s,onChange:this.handleChange})))}},{key:"render",value:function(){return u.createElement(F.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(u.Component);const M=(0,m.Ng)((function(e){return k.pick(e.user,["accountsMap"])}))(w);a(4773);var R=a(3908),S=a(4731),I=a(5093),O=a(2543);const _=function(e,t){var a=I(t);return"daily"===e?a.format("YYYY-MM-DD"):"weekly"===e?a.endOf("week").format("YYYY-MM-DD"):"monthly"===e?a.format("YYYY-MM"):"yearly"===e?a.format("YYYY"):"Overall"};var P=a(2543),Y=function(e,t,a){var n={};e.forEach((function(e){var t=_(a,e.date);n[t]||(n[t]=0),n[t]+=e.amount}));var r=Object.keys(n),l=r.map((function(e){return n[e]}));return{labels:r,data:l}},L=[{title:"Balance Trends Over Time",Chart:S.yP,getData:function(e,t,a){var n=function(e,t){return O.sumBy(O.uniq(O.map(e,(function(e){return e.accountId}))),(function(e){return t[e].openingBalance}))}(e,t),r={};e.forEach((function(e){var t=_(a,e.date);r[t]||(r[t]=n),"CREDIT"===e.type?n+=e.amount:n+=-e.amount,r[t]=n}));var l=Object.keys(r),o=l.map((function(e){return r[e]}));return{labels:l,data:o}},getDatasets:function(e){return[{label:"Balance (INR)",data:e,backgroundColor:"rgb(0, 123, 255)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Debit Over Time",Chart:S.yP,getData:Y,getDatasets:function(e){return[{label:"Debit Transactions (INR)",data:e,backgroundColor:"rgb(220, 53, 70)",fill:!0}]},filters:{type:"DEBIT"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Credit Over Time",Chart:S.yP,getData:Y,getDatasets:function(e){return[{label:"Credit Transactions (INR)",data:e,backgroundColor:"rgb(40, 167, 70)",fill:!0}]},filters:{type:"CREDIT"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Transaction Count Over Time",Chart:S.yP,getData:function(e,t,a){var n={};e.forEach((function(e){var t=_(a,e.date);n[t]||(n[t]=0),n[t]+=1}));var r=Object.keys(n),l=r.map((function(e){return n[e]}));return{labels:r,data:l}},getDatasets:function(e){return[{label:"Transaction Count",data:e,backgroundColor:"rgb(0, 204, 255)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Transaction Count by Amount Range",Chart:S.yP,getData:function(e,t,a){var n=[{label:"< ₹50",min:0,max:50},{label:"₹51 – ₹100",min:51,max:100},{label:"₹101 – ₹500",min:101,max:500},{label:"₹501 – ₹1,000",min:501,max:1e3},{label:"₹1,001 – ₹5,000",min:1001,max:5e3},{label:"₹5,001 – ₹10,000",min:5001,max:1e4},{label:"₹10,001 - ₹50,000",min:10001,max:5e4},{label:"> ₹50,001",min:50001,max:1/0}].map((function(t){var a=t.label,n=t.min,r=t.max;return{label:a,count:e.filter((function(e){return e.amount>=n&&e.amount<=r})).length}}));return{labels:n.map((function(e){return e.label})),data:n.map((function(e){return e.count}))}},getDatasets:function(e){return[{label:"No. of Transactions",data:e,backgroundColor:"rgb(255, 162, 0)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Total Amount by Transaction Range",Chart:S.yP,getData:function(e,t,a){var n=[{label:"< ₹50",min:0,max:50},{label:"₹51 – ₹100",min:51,max:100},{label:"₹101 – ₹500",min:101,max:500},{label:"₹501 – ₹1,000",min:501,max:1e3},{label:"₹1,001 – ₹5,000",min:1001,max:5e3},{label:"₹5,001 – ₹10,000",min:5001,max:1e4},{label:"₹10,001 - ₹50,000",min:10001,max:5e4},{label:"> ₹50,001",min:50001,max:1/0}].map((function(t){var a=t.label,n=t.min,r=t.max,l=e.filter((function(e){return e.amount>=n&&e.amount<=r}));return{label:a,sum:P.sumBy(l,"amount")}}));return{labels:n.map((function(e){return e.label})),data:n.map((function(e){return e.sum}))}},getDatasets:function(e){return[{label:"Total Amount (INR)",data:e,backgroundColor:"rgb(40, 167, 131)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Transaction Count by Tags",Chart:S.yP,getData:function(e,t,a,n){var r=n.map((function(t){var a=t._id;return{label:t.tag,count:e.filter((function(e){return 1==e.appliedRules[a]})).length}}));return r.push({label:"Untagged",count:e.filter((function(e){return 0==e.tags.length})).length}),{labels:(r=r.filter((function(e){return e.count>0}))).map((function(e){return e.label})),data:r.map((function(e){return e.count}))}},getDatasets:function(e){return[{label:"No. of Transactions",data:e,backgroundColor:"rgb(140, 167, 40)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{title:"Total Amount by Tags",Chart:S.yP,getData:function(e,t,a,n){var r=n.map((function(t){var a=t._id,n=t.tag,r=e.filter((function(e){return 1==e.appliedRules[a]}));return{label:n,sum:P.sumBy(r,"amount")}}));return r.push({label:"Untagged",sum:P.sumBy(e.filter((function(e){return 0==e.tags.length})),"amount")}),{labels:(r=r.filter((function(e){return e.sum>0}))).map((function(e){return e.label})),data:r.map((function(e){return e.sum}))}},getDatasets:function(e){return[{label:"Total Amount (INR)",data:e,backgroundColor:"rgb(140, 167, 40)",fill:!0}]},filters:{"account.type":"bank"},groupBy:[],className:"col-sm-12 col-md-6 col-lg-4 mb-3"}],V=a(2543);function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}var q=function(e){function t(){var e,a,n,l;(0,r.A)(this,t);for(var c=arguments.length,m=new Array(c),d=0;d<c;d++)m[d]=arguments[d];return a=this,n=t,l=[].concat(m),n=(0,s.A)(n),e=(0,o.A)(a,j()?Reflect.construct(n,l||[],(0,s.A)(a).constructor):n.apply(a,l)),(0,i.A)(e,"state",{showStatsView:!0}),(0,i.A)(e,"handleChange",(function(t){e.props.dispatch((0,R.B0)(t.target.value))})),(0,i.A)(e,"getChartCard",(function(t,a){var n=e.props,r=n.statsGroupByPeriod,l=n.filteredTransactions,o=n.accountsMap,s=n.rules,c=e.getApplicableTransactions(l,t.filters);if(0==c.length)return null;var i=t.getData(c,o,r,s),m=i.labels,d=i.data,p=t.getDatasets(d);return u.createElement("div",{key:a,className:t.className},u.createElement("div",{className:"card shadow-sm p-3"},u.createElement("h5",{className:"card-title"},t.title),u.createElement("div",{className:"chart-container"},u.createElement(t.Chart,{data:{labels:m,datasets:p}}))))})),e}return(0,c.A)(t,e),(0,l.A)(t,[{key:"getApplicableTransactions",value:function(e,t){return V.filter(e,(function(e){return!!V.isEmpty(t)||V.every(t,(function(t,a){return V.get(e,a)==t}))}))}},{key:"getChartCards",value:function(){return this.state.showStatsView?L.map(this.getChartCard).filter((function(e){return null!=e})):[]}},{key:"render",value:function(){var e=this,t=this.props,a=t.statsGroupByPeriod;if(0==t.filteredTransactions.length)return u.createElement("div",null);var n=this.getChartCards();return 0==n.length?u.createElement("div",null):u.createElement("div",{className:""},u.createElement("div",{className:"mb-2 d-flex align-items-center"},u.createElement("h3",null,"Stats"),u.createElement("select",{className:"form-select w-auto ms-auto me-2",value:a,onChange:this.handleChange},u.createElement("option",{value:"daily"},"Daily"),u.createElement("option",{value:"weekly"},"Weekly"),u.createElement("option",{value:"monthly"},"Monthly"),u.createElement("option",{value:"yearly"},"Yearly"),u.createElement("option",{value:"overall"},"Overall")),u.createElement("button",{className:"btn btn-dark",onClick:function(){return e.setState({showStatsView:!e.state.showStatsView})}},this.state.showStatsView?u.createElement("i",{className:"bi bi-eye-slash-fill"}):u.createElement("i",{className:"bi bi-eye-fill"}))),u.createElement("div",{className:"row"},n))}}])}(u.Component);const U=(0,m.Ng)((function(e){return V.pick(e.user,["statsGroupByPeriod","accountsMap","rules"])}))(q);var X=a(5093),H=a(2543);function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(K=function(){return!!e})()}var G=function(e){function t(){var e,a,n,l;(0,r.A)(this,t);for(var c=arguments.length,m=new Array(c),f=0;f<c;f++)m[f]=arguments[f];return a=this,n=t,l=[].concat(m),n=(0,s.A)(n),e=(0,o.A)(a,K()?Reflect.construct(n,l||[],(0,s.A)(a).constructor):n.apply(a,l)),(0,i.A)(e,"state",{showRulesModal:!1,showTransactionModal:!1,selectedTransaction:null}),(0,i.A)(e,"toggleRulesModal",(function(t){e.setState({showRulesModal:!e.state.showRulesModal,selectedTransaction:t})})),(0,i.A)(e,"handleRuleSave",(function(t){e.toggleRulesModal()})),(0,i.A)(e,"toggleTransactionModal",(function(t){e.setState({showTransactionModal:!e.state.showTransactionModal,selectedTransaction:t})})),(0,i.A)(e,"getTransaction",(function(t,a){return u.createElement("div",{key:a,className:"col-md-6 col-lg-4 mb-2"},u.createElement("div",{className:"card shadow-sm"},u.createElement("div",{className:"card-body"},e.getTags(t),e.getTransactionDate(t),e.getTransactionAccount(t),e.getTransactionAmount(t),e.getTransactionDescription(t),e.getTransactionComments(t))))})),(0,i.A)(e,"saveDrafts",(function(){p.A.saveDrafts().then((function(){d.oR.info("Draft transactions saved ✅"),e.props.fetchTransactions()}))})),(0,i.A)(e,"deleteDrafts",(function(){p.A.deleteDrafts().then((function(){d.oR.info("Draft transactions deleted ✅"),e.props.fetchTransactions()}))})),e}return(0,c.A)(t,e),(0,l.A)(t,[{key:"getCrudRuleModal",value:function(){var e=this,t=this.state,a=t.showRulesModal,n=t.selectedTransaction;return u.createElement(C.A,{show:a,rule:{contains:null==n?void 0:n.description},onSave:this.handleRuleSave,onClose:function(){return e.toggleRulesModal()}})}},{key:"getCrudTransactionModal",value:function(){var e=this,t=this.state,a=t.showTransactionModal,n=t.selectedTransaction;return u.createElement(M,{show:a,transaction:n,onSave:this.props.updateTransaction,isDraft:this.props.isDraft,onClose:function(){return e.toggleTransactionModal()}})}},{key:"removeTransactionTag",value:function(e,t){e.appliedRules[t]=0,p.A.upsert(e).then(this.props.updateTransaction)}},{key:"getDefaultTag",value:function(e,t){return u.createElement("span",{className:"badge bg-"+t+" mb-2 me-1"},e)}},{key:"getTag",value:function(e,t){var a,n=this,r=this.props.rulesMap;return u.createElement("div",{key:t,className:"badge bg-primary mb-2 me-1"},null===(a=r[t])||void 0===a?void 0:a.tag,u.createElement("span",{className:"ms-1 cursor-pointer",onClick:function(){return n.removeTransactionTag(e,t)}},"×"))}},{key:"getTransactionTypeBg",value:function(e){return e==f.t2.CREDIT?"success":"danger"}},{key:"getTags",value:function(e){var t=this,a=H.keys(H.pickBy(e.appliedRules,(function(e){return 1==e})));return u.createElement("div",{className:"d-flex "},u.createElement("div",{className:"d-flex flex-wrap"},this.getDefaultTag(e.type,this.getTransactionTypeBg(e.type)),1==e.excludeFromTotals&&this.getDefaultTag("Excluded","secondary"),0==a.length&&this.getDefaultTag("Others","dark"),a.map((function(a){return t.getTag(e,a)}))),u.createElement("div",{className:"ms-auto d-flex flex-wrap justify-content-end"},u.createElement("span",{className:"badge bg-secondary mb-2 me-1 cursor-pointer",onClick:function(){return t.toggleRulesModal(e)}},"+"),u.createElement("span",{className:"badge bg-secondary cursor-pointer mb-2 me-1",onClick:function(){return t.toggleTransactionModal(e)}},u.createElement("i",{className:"bi bi-pencil"})),u.createElement("span",{className:"badge bg-secondary cursor-pointer mb-2 me-1",onClick:function(){return t.props.deleteTransaction(e)}},u.createElement("i",{className:"bi bi-trash"}))))}},{key:"getTransactionDate",value:function(e){return u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.DATE,":")," ",(t=e.date,X(t,"YYYY-MM-DD")).format("MMMM D, YYYY (dddd)"));var t}},{key:"getTransactionAccount",value:function(e){return e.account&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.ACCOUNT,":")," ",h.A.getAccountLabel(e.account))}},{key:"getTransactionAmount",value:function(e){return u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.AMOUNT,": "),u.createElement("span",{className:"badge bg-"+this.getTransactionTypeBg(e.type)},"₹",E.A.getFormattedAmount(e.amount)))}},{key:"getTransactionDescription",value:function(e){var t=e.description;return!H.isEmpty(t)&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.DESCRIPTION,":")," ",t)}},{key:"getTransactionComments",value:function(e){var t=e.comments;return!H.isEmpty(t)&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.COMMENTS,":")," ",t)}},{key:"getTransactionsCountLabel",value:function(e){return u.createElement("div",{className:"d-flex justify-content-center"},u.createElement("span",{className:"text-muted"},"Showing ",e.length," of ",this.props.transactions.length," transactions."))}},{key:"getDraftActions",value:function(e){return 1==this.props.isDraft&&this.props.transactions.length>0&&u.createElement("div",{className:"mt-2 d-flex justify-content-center"},u.createElement("button",{className:"btn btn-primary me-2",onClick:this.saveDrafts},"Save All"),u.createElement("button",{className:"btn btn-danger",onClick:this.deleteDrafts},"Delete All"))}},{key:"getTransactions",value:function(e){return this.props.transactions.length>0&&u.createElement("div",null,u.createElement(U,{filteredTransactions:e}),u.createElement(N,{transactions:e,accounts:this.props.accounts}),this.getTransactionsCountLabel(e),this.getDraftActions(e),u.createElement("div",{className:"row mt-2"},e.slice().reverse().map(this.getTransaction)),this.getDraftActions(e))}},{key:"getAddButton",value:function(){var e=this;return u.createElement("button",{className:"btn btn-dark rounded-circle position-fixed bottom-0 end-0 m-2",onClick:function(){return e.toggleTransactionModal()},style:{width:"50px",height:"50px"}},u.createElement("i",{className:"bi bi-database-fill-add"}))}},{key:"render",value:function(){var e=this.props.filteredTransactions;return u.createElement("div",{className:"mb-2"},this.getTransactions(e),this.getAddButton(),this.getCrudRuleModal(),this.getCrudTransactionModal())}}])}(u.Component);const Z=(0,m.Ng)((function(e){return H.pick(e.user,["accountsMap","accounts","rulesMap"])}))(G);var W=a(2543);var $=a(2543);const z=function(e,t,a,n){return $.filter(e,(function(e){if(!$.isEmpty(t.minAmountFilter)&&e.amount<t.minAmountFilter)return!1;if(!$.isEmpty(t.maxAmountFilter)&&e.amount>t.maxAmountFilter)return!1;if(!$.isEmpty(t.excludeFromTotalsFilter)&&e.excludeFromTotals!=t.excludeFromTotalsFilter)return!1;var r=a&&a[e.accountId]||{};if(e.account=r,!$.isEmpty(t.accountTypeFilter)&&r.type!=t.accountTypeFilter)return!1;if(!$.isEmpty(t.accountIdFilter)&&e.accountId!=t.accountIdFilter)return!1;if(!$.isEmpty(t.transactionTypeFilter)&&e.type!=t.transactionTypeFilter)return!1;if(function(e,t){var a=[];t.forEach((function(t){var n=t._id,r=t.keywords,l=t.tag;if(e.appliedRules=e.appliedRules||{},0!=e.appliedRules[n]){var o=W.toLower(e.description);W.some(W.split(W.toLower(r),","),(function(e){return o.includes(W.trim(e))}))&&(e.appliedRules[n]=1,a.push(l))}})),e.tags=a}(e,n),!$.isEmpty(t.tagFilter))if("__NONE__"==t.tagFilter){if(e.tags.length>0)return!1}else if(!e.appliedRules[t.tagFilter])return!1;return!(!$.isEmpty(t.searchFilter)&&!$.includes($.toLower(e.description),$.toLower(t.searchFilter)))}))};var J=a(3632),Q=a(2543);function ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(a),!0).forEach((function(t){(0,i.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ee(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ae=function(){return!!e})()}var ne=function(e){function t(){var e,a,l,c;(0,r.A)(this,t);for(var u=arguments.length,m=new Array(u),f=0;f<u;f++)m[f]=arguments[f];return a=this,l=t,c=[].concat(m),l=(0,s.A)(l),e=(0,o.A)(a,ae()?Reflect.construct(l,c||[],(0,s.A)(a).constructor):l.apply(a,c)),(0,i.A)(e,"state",te(te(te({},e.getInitialDateFilters()),e.getInitialFilters()),{},{transactions:[],transactionsLoading:!1})),(0,i.A)(e,"handleDateFilterChange",(function(t,a){e.setState((0,i.A)({},t,a),e.fetchTransactions)})),(0,i.A)(e,"resetDateFilter",(function(){e.setState(e.getInitialDateFilters(),e.fetchTransactions)})),(0,i.A)(e,"handleFilterChange",(function(t,a){e.setState((0,i.A)({},t,a),(function(){"startDateFilter"!=t&&"endDateFilter"!=t||e.fetchTransactions()}))})),(0,i.A)(e,"resetFilters",(function(){e.setState(e.getInitialFilters())})),(0,i.A)(e,"updateTransaction",(function(t){e.setState((function(e){var a=(0,n.A)(e.transactions),r=Q.findIndex(a,(function(e){return e._id===t._id}));return r>=0?a[r]=t:a.push(t),{transactions:a,showTransactionModal:!1}}))})),(0,i.A)(e,"deleteTransaction",(function(t){p.A.delete(t._id).then((function(t){e.setState((function(e){return{transactions:e.transactions.filter((function(e){return e._id!==t._id}))}}),(function(){return d.oR.info("Transaction deleted ✅")}))}))})),(0,i.A)(e,"fetchTransactions",(function(){e.setState({transactions:[],transactionsLoading:!0}),p.A.getAll(e.state.startDateFilter,e.state.endDateFilter,e.props.isDraft,e.props.sortByDate).then((function(t){e.setState({transactions:t.transactions,transactionsLoading:!1})}))})),e}return(0,c.A)(t,e),(0,l.A)(t,[{key:"getInitialDateFilters",value:function(){return{startDateFilter:this.props.startDateFilter||"",endDateFilter:this.props.endDateFilter||""}}},{key:"getFilters",value:function(){return{startDateFilter:this.state.startDateFilter,endDateFilter:this.state.endDateFilter,minAmountFilter:this.state.minAmountFilter,maxAmountFilter:this.state.maxAmountFilter,excludeFromTotalsFilter:this.state.excludeFromTotalsFilter,accountTypeFilter:this.state.accountTypeFilter,accountIdFilter:this.state.accountIdFilter,transactionTypeFilter:this.state.transactionTypeFilter,tagFilter:this.state.tagFilter,searchFilter:this.state.searchFilter}}},{key:"getInitialFilters",value:function(){return{minAmountFilter:"",maxAmountFilter:"",accountTypeFilter:"",accountIdFilter:"",transactionTypeFilter:"",tagFilter:"",excludeFromTotalsFilter:"0",searchFilter:""}}},{key:"getFiltersView",value:function(){return u.createElement(y,{filters:this.getFilters(),handleFilterChange:this.handleFilterChange,resetFilters:this.resetFilters,resetDateFilter:this.resetDateFilter})}},{key:"getNoTransactionsLabel",value:function(){return this.props.isDraft?u.createElement("div",{className:"text-muted"},"No drafts transactions found."):u.createElement("div",{className:"text-muted"},"No transactions found.")}},{key:"getLoader",value:function(){return this.state.transactionsLoading?J.A.spinnerLoader("mt-3"):0==this.state.transactions.length?u.createElement("div",{className:"mt-3 mb-3 text-center"},this.getNoTransactionsLabel()):void 0}},{key:"getFilteredTransactions",value:function(){return z(this.state.transactions,this.getFilters(),this.props.accountsMap,this.props.rules)}},{key:"getLayoutBody",value:function(){var e=this.getFilteredTransactions();return u.createElement(Z,{isDraft:this.props.isDraft,transactions:this.state.transactions,filteredTransactions:e,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction,fetchTransactions:this.fetchTransactions})}},{key:"render",value:function(){return u.createElement("div",{className:""},this.getFiltersView(),this.getLoader(),this.getLayoutBody())}},{key:"componentDidMount",value:function(){this.fetchTransactions()}}])}(u.Component);const re=(0,m.Ng)((function(e){return Q.pick(e.user,["accountsMap","rules"])}))(ne)}}]);