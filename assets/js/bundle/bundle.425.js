"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[425],{3145:(t,e,n)=>{function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,{A:()=>a})},5474:(t,e,n)=>{n.d(e,{E5:()=>r,Tv:()=>u,WB:()=>s,_Y:()=>i,jy:()=>o,nZ:()=>c,t2:()=>l});var a=n(4467),r="681626859343-dtkml0ds42u48qg1q5nr07kevma99tfk.apps.googleusercontent.com",i={bank:"Bank",cash:"Cash",credit_card:"Credit Card"},s={DATE:"date",ACCOUNT_GROUP:"accountGroup",ACCOUNT_ID:"accountId",DESCRIPTION:"description",TYPE:"transactionType",AMOUNT:"amount",DEBIT:"debit",CREDIT:"credit",BALANCE:"balance"},o=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},s.DATE,"Date"),s.ACCOUNT_GROUP,"Account Group"),s.ACCOUNT_ID,"Account"),s.TYPE,"Transaction Type"),s.AMOUNT,"Amount"),s.DESCRIPTION,"Description"),l={DEBIT:"DEBIT",CREDIT:"CREDIT"},c={DEBIT:"Debit",CREDIT:"Credit"},u={HDFC_AS_XLS_V1:"HDFC - XLS - V1",SBI_AS_XLS_V1:"SBI - XLS - V1",AXIS_AS_PDF_V1:"AXIS - PDF - V1"}},7425:(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var a=n(3145),r=n(7800);var i=n(3029),s=n(2901),o=n(4441),l=n(3954),c=n(5501),u=n(4467),m=n(6540),p=n(1225),d=n(378),f=n(8736),h=n(5474),g=n(2543);function F(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(F=function(){return!!t})()}var v=function(t){function e(){var t,n,a,r;(0,i.A)(this,e);for(var s=arguments.length,c=new Array(s),p=0;p<s;p++)c[p]=arguments[p];return n=this,a=e,r=[].concat(c),a=(0,l.A)(a),t=(0,o.A)(n,F()?Reflect.construct(a,r||[],(0,l.A)(n).constructor):a.apply(n,r)),(0,u.A)(t,"state",{showFiltersView:!1}),(0,u.A)(t,"handleFilterChange",(function(e){t.props.handleFilterChange(e.target.name,e.target.value)})),(0,u.A)(t,"getDateFilter",(function(){var e=t.props.filters;return m.createElement("div",{className:""},m.createElement("div",{className:"input-group m-0"},m.createElement("span",{className:"input-group-text"},"From"),m.createElement("input",{type:"date",name:"startDateFilter",value:e.startDateFilter,className:"form-control",onChange:t.handleFilterChange}),m.createElement("span",{className:"input-group-text"},"To"),m.createElement("input",{type:"date",name:"endDateFilter",value:e.endDateFilter,className:"form-control",onChange:t.handleFilterChange}),m.createElement("button",{className:"btn btn-dark",onClick:function(){return t.props.resetDateFilter("startDateFilter","")}},m.createElement("i",{className:"bi bi-x-circle-fill"}))))})),t}return(0,c.A)(e,t),(0,s.A)(e,[{key:"toggleFiltersView",value:function(){this.setState({showFiltersView:!this.state.showFiltersView})}},{key:"getFilters",value:function(){var t=this;if(!this.state.showFiltersView)return this.getFiltersButton();var e=this.props,n=e.accountsMap,a=e.rulesMap,r=e.filters;return m.createElement("div",{className:"p-3 bg-dark-subtle"},m.createElement("div",{className:"row"},m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Min"),m.createElement("input",{type:"number",name:"minAmountFilter",value:r.minAmountFilter,className:"form-control",onChange:this.handleFilterChange}),m.createElement("span",{className:"input-group-text"},"Max"),m.createElement("input",{type:"number",name:"maxAmountFilter",value:r.maxAmountFilter,className:"form-control",onChange:this.handleFilterChange}))),n&&m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Account Group"),m.createElement("select",{name:"accountGroupFilter",value:r.accountGroupFilter,className:"form-control",onChange:this.handleFilterChange},m.createElement("option",{value:""},"All"),g.keys(g.groupBy(this.props.accountsMap,"accountGroup")).map((function(t,e){return m.createElement("option",{key:e,value:t},h._Y[t])}))))),n&&m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Account"),m.createElement("select",{name:"accountIdFilter",value:r.accountIdFilter,className:"form-control",onChange:this.handleFilterChange},m.createElement("option",{value:""},"All"),g.values(this.props.accountsMap).map((function(t,e){return m.createElement("option",{key:e,value:t._id},t.name," (",h._Y[t.accountGroup],")")}))))),m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Transaction Type"),m.createElement("select",{name:"transactionTypeFilter",value:r.transactionTypeFilter,className:"form-control",onChange:this.handleFilterChange},m.createElement("option",{value:""},"All"),m.createElement("option",{value:h.t2.DEBIT},"Debit"),m.createElement("option",{value:h.t2.CREDIT},"Credit")))),m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Tag"),m.createElement("select",{name:"tagFilter",value:r.tagFilter,className:"form-control",onChange:this.handleFilterChange},m.createElement("option",{value:""},"All"),m.createElement("option",{value:"__NONE__"},"Others"),g.values(a).map((function(t,e){return m.createElement("option",{key:e,value:t._id},t.tag)}))))),m.createElement("div",{className:"col-lg-3 col-md-4 col-sm-12 mb-2"},m.createElement("div",{className:"input-group"},m.createElement("span",{className:"input-group-text"},"Search"),m.createElement("input",{type:"search",name:"searchFilter",value:r.searchFilter,className:"form-control",onChange:this.handleFilterChange})))),m.createElement("button",{className:"btn btn-sm btn-dark me-2",onClick:function(){return t.toggleFiltersView()}},m.createElement("i",{className:"bi bi-eye-slash-fill"})),m.createElement("button",{className:"btn btn-sm btn-dark me-2",onClick:this.props.resetFilters},m.createElement("i",{className:"bi bi-x-circle-fill"})))}},{key:"getFiltersButton",value:function(){var t=this;return m.createElement("button",{className:"btn btn-dark rounded-circle m-2",onClick:function(){return t.toggleFiltersView()},style:{width:"50px",height:"50px"}},m.createElement("i",{className:"bi bi-funnel-fill"}))}},{key:"render",value:function(){return m.createElement("div",{className:""},this.getDateFilter(),m.createElement("div",{className:"position-fixed z-1 bottom-0 start-0"},this.getFilters()))}}])}(m.Component);const A=(0,p.Ng)((function(t){return g.pick(t.user,["accountsMap","rulesMap"])}))(v);var E=n(2543);var y=n(2543);const N=function(t,e,n,a){return y.filter(t,(function(t){if(!y.isEmpty(e.minAmountFilter)&&t.amount<e.minAmountFilter)return!1;if(!y.isEmpty(e.maxAmountFilter)&&t.amount>e.maxAmountFilter)return!1;var r=n&&n[t.accountId]||{};return t.accountGroup=h._Y[r.accountGroup]||"",t.accountName=r.name||"",!(!y.isEmpty(e.accountGroupFilter)&&r.accountGroup!=e.accountGroupFilter||!y.isEmpty(e.accountIdFilter)&&t.accountId!=e.accountIdFilter||!y.isEmpty(e.transactionTypeFilter)&&t.transactionType!=e.transactionTypeFilter||(function(t,e){var n=[];e.forEach((function(e){var a=e._id,r=e.contains,i=e.tag;if(t.appliedRules=t.appliedRules||{},0!=t.appliedRules[a]){var s=E.lowerCase(t.description),o=E.split(E.lowerCase(r),",");E.some(o,(function(t){return s.includes(t)}))&&(t.appliedRules[a]=1,n.push(i))}})),t.tags=n}(t,a),y.isEmpty(e.tagFilter)?!y.isEmpty(e.searchFilter)&&!y.includes(y.lowerCase(t.description),y.lowerCase(e.searchFilter)):!("__NONE__"==e.tagFilter&&0==t.tags.length||e.tagFilter in t.appliedRules&&1==t.appliedRules[e.tagFilter])))}))};var D=n(9097),b=n(3632),C=n(2543);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){(0,u.A)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(I=function(){return!!t})()}var _=function(t){function e(){var t,n,s,c;(0,i.A)(this,e);for(var m=arguments.length,p=new Array(m),h=0;h<m;h++)p[h]=arguments[h];return n=this,s=e,c=[].concat(p),s=(0,l.A)(s),t=(0,o.A)(n,I()?Reflect.construct(s,c||[],(0,l.A)(n).constructor):s.apply(n,c)),(0,u.A)(t,"state",k(k(k({},t.getInitialDateFilters()),t.getInitialFilters()),{},{transactions:[],transactionsLoading:!1})),(0,u.A)(t,"handleDateFilterChange",(function(e,n){t.setState((0,u.A)({},e,n),t.fetchTransactions)})),(0,u.A)(t,"resetDateFilter",(function(){t.setState(t.getInitialDateFilters(),t.fetchTransactions)})),(0,u.A)(t,"handleFilterChange",(function(e,n){t.setState((0,u.A)({},e,n),(function(){"startDateFilter"!=e&&"endDateFilter"!=e||t.fetchTransactions()}))})),(0,u.A)(t,"resetFilters",(function(){t.setState(t.getInitialFilters())})),(0,u.A)(t,"updateTransaction",(function(e){t.setState((function(t){var n,i=function(t){if(Array.isArray(t))return(0,a.A)(t)}(n=t.transactions)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||(0,r.A)(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=C.findIndex(i,(function(t){return t._id===e._id}));return s>=0?i[s]=e:i.push(e),{transactions:i,showTransactionModal:!1}}))})),(0,u.A)(t,"deleteTransaction",(function(e){f.A.delete(e._id).then((function(e){t.setState((function(t){return{transactions:t.transactions.filter((function(t){return t._id!==e._id}))}}),(function(){return d.oR.info("Transaction deleted ✅")}))}))})),(0,u.A)(t,"fetchTransactions",(function(){t.setState({transactions:[],transactionsLoading:!0}),f.A.getAll(t.state.startDateFilter,t.state.endDateFilter,t.props.isDraft).then((function(e){t.setState({transactions:e.transactions,transactionsLoading:!1})}))})),t}return(0,c.A)(e,t),(0,s.A)(e,[{key:"getInitialDateFilters",value:function(){return{startDateFilter:this.props.startDateFilter||"",endDateFilter:this.props.endDateFilter||""}}},{key:"getFilters",value:function(){return{startDateFilter:this.state.startDateFilter,endDateFilter:this.state.endDateFilter,minAmountFilter:this.state.minAmountFilter,maxAmountFilter:this.state.maxAmountFilter,accountGroupFilter:this.state.accountGroupFilter,accountIdFilter:this.state.accountIdFilter,transactionTypeFilter:this.state.transactionTypeFilter,tagFilter:this.state.tagFilter,searchFilter:this.state.searchFilter}}},{key:"getInitialFilters",value:function(){return{minAmountFilter:"",maxAmountFilter:"",accountGroupFilter:"",accountIdFilter:"",transactionTypeFilter:"",tagFilter:"",searchFilter:""}}},{key:"getFiltersView",value:function(){return m.createElement(A,{filters:this.getFilters(),handleFilterChange:this.handleFilterChange,resetFilters:this.resetFilters,resetDateFilter:this.resetDateFilter})}},{key:"getNoTransactionsLabel",value:function(){return this.props.isDraft?m.createElement("div",{className:"text-muted"},"No drafts transactions found."):m.createElement("div",{className:"text-muted"},"No transactions found.")}},{key:"getLoader",value:function(){return this.state.transactionsLoading?b.A.spinnerLoader("mt-3"):0==this.state.transactions.length?m.createElement("div",{className:"mt-3 mb-3 text-center"},this.getNoTransactionsLabel()):void 0}},{key:"getFilteredTransactions",value:function(){return N(this.state.transactions,this.getFilters(),this.props.accountsMap,this.props.rules)}},{key:"getLayoutBody",value:function(){var t=this.props.LayoutBody,e=this.getFilteredTransactions();return m.createElement(D.A,{component:t,isDraft:this.props.isDraft,transactions:this.state.transactions,filteredTransactions:e,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction,fetchTransactions:this.fetchTransactions})}},{key:"render",value:function(){return m.createElement("div",{className:""},this.getFiltersView(),this.getLoader(),this.getLayoutBody())}},{key:"componentDidMount",value:function(){this.fetchTransactions()}}])}(m.Component);const w=(0,p.Ng)((function(t){return C.pick(t.user,["accountsMap","rules"])}))(_)},7800:(t,e,n)=>{n.d(e,{A:()=>r});var a=n(3145);function r(t,e){if(t){if("string"==typeof t)return(0,a.A)(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,a.A)(t,e):void 0}}},8736:(t,e,n)=>{n.d(e,{A:()=>r});var a=n(4297);const r={extract:function(t,e,n){var r=new FormData;return r.append("accountId",t),r.append("extractor",e),r.append("file",n),a.A.post("/api/v1/transactions/extract",r,{"Content-Type":"multipart/form-data"})},saveDrafts:function(){return a.A.post("/api/v1/transactions/save-drafts")},deleteDrafts:function(){return a.A.post("/api/v1/transactions/delete-drafts")},getAll:function(t,e,n){return a.A.get("/api/v1/transactions",{startDate:t,endDate:e,isDraft:n})},upsert:function(t){return a.A.post("/api/v1/transaction",t)},delete:function(t){return a.A.delete("/api/v1/transaction/".concat(t))}}}}]);