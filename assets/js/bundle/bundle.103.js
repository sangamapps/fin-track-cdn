"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[103],{6103:(t,e,a)=>{a.r(e),a.d(e,{default:()=>k});var n=a(467),r=a(3029),c=a(2901),o=a(4441),s=a(3954),l=a(5501),u=a(4467),i=a(4756),d=a.n(i),m=a(6540),f=a(1225),p=a(4625),v=a(378),h=a(5474),A=a(7634),g=a(8736),E=a(3632),x=a(2543);function C(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(C=function(){return!!t})()}var b=function(t){function e(){var t,a,c,l;(0,r.A)(this,e);for(var i=arguments.length,m=new Array(i),f=0;f<i;f++)m[f]=arguments[f];return a=this,c=e,l=[].concat(m),c=(0,s.A)(c),t=(0,o.A)(a,C()?Reflect.construct(c,l||[],(0,s.A)(a).constructor):c.apply(a,l)),(0,u.A)(t,"state",{accountId:"",extractor:"",file:null,extractionStatus:!1,extracted:0,transactionsCount:0,showAccountModal:!1}),(0,u.A)(t,"toggleAccountModal",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.state.accountId;t.setState({showAccountModal:!t.state.showAccountModal,accountId:e})})),(0,u.A)(t,"handleChange",(function(e){t.setState((0,u.A)({},e.target.name,e.target.value))})),(0,u.A)(t,"handleFileUpload",function(){var e=(0,n.A)(d().mark((function e(a){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.target.files[0],t.setState({file:n,extracted:0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,u.A)(t,"getTransactions",(function(e){e.preventDefault(),t.setState({extractionStatus:!0,extracted:0}),g.A.extract(t.state.accountId,t.state.extractor,t.state.file).then((function(e){t.setState({transactionsCount:e.transactionsCount,extractionStatus:!1,extracted:1})})).catch((function(e){t.setState({extractionStatus:!1,extracted:0}),v.oR.error(e.message)}))})),t}return(0,l.A)(e,t),(0,c.A)(e,[{key:"getUploadCard",value:function(){var t=this,e=this.state,a=e.accountId,n=e.extractor;return m.createElement("form",{className:"p-3 shadow mb-3",onSubmit:this.getTransactions},m.createElement("h3",{className:"mb-3"},"Upload Statement"),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Select Account"),m.createElement("div",{className:"d-flex"},m.createElement("select",{className:"form-select me-2",name:"accountId",value:a,onChange:this.handleChange,required:!0},m.createElement("option",{value:""}),this.props.accounts.map((function(t,e){return m.createElement("option",{key:e,value:t._id},t.name)}))),m.createElement("button",{className:"btn btn-dark",onClick:function(){return t.toggleAccountModal()}},"+"))),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Select Extractor"),m.createElement("select",{className:"form-select",name:"extractor",value:n,onChange:this.handleChange,required:!0},m.createElement("option",{value:""}),x.keys(h.Tv).map((function(t,e){return m.createElement("option",{key:e,value:t},h.Tv[t])})))),m.createElement("div",{className:"mb-3"},m.createElement("input",{type:"file",className:"form-control",onChange:this.handleFileUpload,required:!0})),m.createElement("div",null,m.createElement("button",{className:"btn btn-dark"},"Extract Transactions")))}},{key:"getResult",value:function(){var t=this.state,e=t.extractionStatus,a=t.transactionsCount,n=t.extracted;return e?E.A.spinnerLoader("mt-4"):n?m.createElement("div",{className:"mt-4 alert alert-success"},m.createElement("span",null,"Extracted ",a," transactions. "),a>0&&m.createElement("span",null,"Visit ",m.createElement(p.N_,{to:"/transactions/drafts"},"Edit Drafts")," page to review and save draft transactions.")):void 0}},{key:"getCrudRuleModal",value:function(){var t=this;return m.createElement(A.A,{show:this.state.showAccountModal,onSave:function(e){return t.toggleAccountModal(e.account._id)},onClose:function(){return t.toggleAccountModal()}})}},{key:"render",value:function(){return m.createElement("div",{className:"mb-3"},this.getUploadCard(),this.getCrudRuleModal(),this.getResult())}}])}(m.Component);const k=(0,f.Ng)((function(t){return x.pick(t.user,["accounts"])}))(b)},8736:(t,e,a)=>{a.d(e,{A:()=>r});var n=a(4297);const r={extract:function(t,e,a){var r=new FormData;return r.append("accountId",t),r.append("extractor",e),r.append("file",a),n.A.post("/api/v1/transactions/extract",r,{"Content-Type":"multipart/form-data"})},saveDrafts:function(){return n.A.post("/api/v1/transactions/save-drafts")},deleteDrafts:function(){return n.A.post("/api/v1/transactions/delete-drafts")},getAll:function(t,e,a,r){return n.A.get("/api/v1/transactions",{startDate:t,endDate:e,isDraft:a,sortByDate:r})},upsert:function(t){return n.A.post("/api/v1/transaction",t)},delete:function(t){return n.A.delete("/api/v1/transaction/".concat(t))}}}}]);