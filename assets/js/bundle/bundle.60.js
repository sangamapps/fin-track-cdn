"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[60],{5060:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var a=n(3029),r=n(2901),o=n(4441),s=n(3954),c=n(5501),l=n(4467),i=n(6540),u=n(1225),m=n(378),d=n(8736),p=n(5474),f=n(2543);function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var g=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,s.A)(n),(0,o.A)(e,v()?Reflect.construct(n,r||[],(0,s.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,c.A)(t,e),(0,r.A)(t,[{key:"render",value:function(){var e=this.props.transactions;if(f.isEmpty(e))return i.createElement(i.Fragment,null);var t=f.groupBy(e,"transactionType"),n=f.sumBy(t[p.t2.DEBIT],(function(e){return e[p.WB.AMOUNT]})),a=f.sumBy(t[p.t2.CREDIT],(function(e){return e[p.WB.AMOUNT]}));return i.createElement("div",{className:"mt-2"},i.createElement("table",{className:"table table-bordered text-center"},i.createElement("thead",{className:""},i.createElement("tr",{className:"table-primary"},i.createElement("th",null,"Total Debits"),i.createElement("th",null,"Total Credits"))),i.createElement("tbody",null,i.createElement("tr",null,i.createElement("td",null,n),i.createElement("td",null,a)))))}}])}(i.Component),h=n(756),T=n(1820),E=n(5093),A=n(2543);function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}function b(e){var t,n,a,r,o;return{date:(null===(t=e.transaction)||void 0===t?void 0:t.date)||E().format("YYYY-MM-DD"),transactionType:(null===(n=e.transaction)||void 0===n?void 0:n.transactionType)||p.t2.DEBIT,accountId:(null===(a=e.transaction)||void 0===a?void 0:a.accountId)||"",amount:(null===(r=e.transaction)||void 0===r?void 0:r.amount)||0,description:(null===(o=e.transaction)||void 0===o?void 0:o.description)||""}}var D=function(e){function t(e){var n,r,c,u;return(0,a.A)(this,t),r=this,c=t,u=[e],c=(0,s.A)(c),n=(0,o.A)(r,y()?Reflect.construct(c,u||[],(0,s.A)(r).constructor):c.apply(r,u)),(0,l.A)(n,"handleChange",(function(e){n.setState((0,l.A)({},e.target.name,e.target.value))})),(0,l.A)(n,"handleSubmit",(function(e){e.preventDefault();var t=A.assign(n.props.transaction,n.state);t.amount=parseFloat(t.amount),n.props.isDraft&&(t.isDraft=!0),d.A.upsert(t).then((function(e){m.oR.info("Transaction saved ✅"),n.props.onSave(e.transaction)}))})),(0,l.A)(n,"onSubmitClick",(function(){n.formRef.current&&n.formRef.current.requestSubmit()})),n.state=b(e),n.formRef=i.createRef(),n}return(0,c.A)(t,e),(0,r.A)(t,[{key:"componentDidUpdate",value:function(e){e.transaction!==this.props.transaction&&this.setState(b(this.props))}},{key:"getModalTitle",value:function(){return this.props.transaction?"Edit Transaction":"Add Transaction"}},{key:"getModalBody",value:function(){var e=this.state,t=e.date,n=e.description,a=e.accountId,r=e.transactionType,o=e.amount,s=this.props.accountsMap;return i.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Date"),i.createElement("input",{type:"date",className:"form-control",name:"date",value:t,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Transaction Type"),i.createElement("select",{className:"form-select",name:"transactionType",value:r,onChange:this.handleChange,required:!0},i.createElement("option",{value:""}),i.createElement("option",{value:"DEBIT"},"Debit"),i.createElement("option",{value:"CREDIT"},"Credit"))),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Account"),i.createElement("select",{className:"form-select",name:"accountId",value:a,onChange:this.handleChange,required:!0},i.createElement("option",{value:""}),A.values(s).map((function(e,t){return i.createElement("option",{key:t,value:e._id},e.name," (",p._Y[e.accountGroup],")")})))),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Amount"),i.createElement("input",{type:"number",className:"form-control",name:"amount",value:o,onChange:this.handleChange,required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Description"),i.createElement("input",{type:"text",className:"form-control",name:"description",value:n,onChange:this.handleChange})))}},{key:"render",value:function(){return i.createElement(T.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(i.Component);const C=(0,u.Ng)((function(e){return A.pick(e.user,["accountsMap"])}))(D);var N=n(5093),k=n(2543);function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}var R=function(e){function t(){var e,n,r,c;(0,a.A)(this,t);for(var u=arguments.length,p=new Array(u),f=0;f<u;f++)p[f]=arguments[f];return n=this,r=t,c=[].concat(p),r=(0,s.A)(r),e=(0,o.A)(n,M()?Reflect.construct(r,c||[],(0,s.A)(n).constructor):r.apply(n,c)),(0,l.A)(e,"state",{showRulesModal:!1,showTransactionModal:!1,selectedTransaction:null}),(0,l.A)(e,"toggleRulesModal",(function(t){e.setState({showRulesModal:!e.state.showRulesModal,selectedTransaction:t})})),(0,l.A)(e,"handleRuleSave",(function(t){e.toggleRulesModal()})),(0,l.A)(e,"toggleTransactionModal",(function(t){e.setState({showTransactionModal:!e.state.showTransactionModal,selectedTransaction:t})})),(0,l.A)(e,"getTransaction",(function(t,n){return i.createElement("div",{key:n,className:"col-md-6 col-lg-4 mb-2"},i.createElement("div",{className:"card shadow-sm"},i.createElement("div",{className:"card-body"},e.getTags(t),e.getTransactionDate(t),e.getTransactionAccountGroup(t),e.getTransactionAccount(t),e.getTransactionAmount(t),e.getTransactionDescription(t))))})),(0,l.A)(e,"saveDrafts",(function(){d.A.saveDrafts().then((function(){m.oR.info("Draft transactions saved ✅"),e.props.fetchTransactions()}))})),(0,l.A)(e,"deleteDrafts",(function(){d.A.deleteDrafts().then((function(){m.oR.info("Draft transactions deleted ✅"),e.props.fetchTransactions()}))})),e}return(0,c.A)(t,e),(0,r.A)(t,[{key:"getInitialFilters",value:function(){return{startDateFilter:this.props.startDateFilter||"",endDateFilter:this.props.endDateFilter||"",accountGroupFilter:"",accountIdFilter:"",transactionTypeFilter:"",tagFilter:""}}},{key:"getCrudRuleModal",value:function(){var e=this,t=this.state,n=t.showRulesModal,a=t.selectedTransaction;return i.createElement(h.A,{show:n,rule:{contains:null==a?void 0:a.description},onSave:this.handleRuleSave,onClose:function(){return e.toggleRulesModal()}})}},{key:"getCrudTransactionModal",value:function(){var e=this,t=this.state,n=t.showTransactionModal,a=t.selectedTransaction;return i.createElement(C,{show:n,transaction:a,onSave:this.props.updateTransaction,isDraft:this.props.isDraft,onClose:function(){return e.toggleTransactionModal()}})}},{key:"removeTransactionTag",value:function(e,t){e.appliedRules[t]=0,d.A.upsert(e).then(this.props.updateTransaction)}},{key:"getDefaultTag",value:function(e,t){return i.createElement("span",{className:"badge bg-"+t+" mb-2 me-1"},e)}},{key:"getTag",value:function(e,t){var n,a=this,r=this.props.rulesMap;return i.createElement("div",{key:t,className:"badge bg-primary mb-2 me-1"},null===(n=r[t])||void 0===n?void 0:n.tag,i.createElement("span",{className:"ms-1 cursor-pointer",onClick:function(){return a.removeTransactionTag(e,t)}},"×"))}},{key:"getTransactionTypeBg",value:function(e){return e==p.t2.CREDIT?"success":"warning"}},{key:"getTags",value:function(e){var t=this,n=k.keys(k.pickBy(e.appliedRules,(function(e){return 1==e})));return i.createElement("div",{className:"d-flex "},i.createElement("div",{className:"d-flex flex-wrap"},this.getDefaultTag(e.transactionType,this.getTransactionTypeBg(e.transactionType)),0==n.length&&this.getDefaultTag("Others","dark"),n.map((function(n){return t.getTag(e,n)}))),i.createElement("div",{className:"ms-auto d-flex flex-wrap justify-content-end"},i.createElement("span",{className:"badge bg-secondary mb-2 me-1 cursor-pointer",onClick:function(){return t.toggleRulesModal(e)}},"+"),i.createElement("span",{className:"badge bg-secondary cursor-pointer mb-2 me-1",onClick:function(){return t.toggleTransactionModal(e)}},i.createElement("i",{className:"bi bi-pencil"})),i.createElement("span",{className:"badge bg-danger cursor-pointer mb-2 me-1",onClick:function(){return t.props.deleteTransaction(e)}},i.createElement("i",{className:"bi bi-trash"}))))}},{key:"getTransactionDate",value:function(e){return i.createElement("div",{className:"mb-1"},i.createElement("strong",null,p.jy[p.WB.DATE],":")," ",(t=e[p.WB.DATE],N(t,"YYYY-MM-DD")).format("MMMM D, YYYY (dddd)"));var t}},{key:"getTransactionAccountGroup",value:function(e){return e.accountGroup&&i.createElement("div",{className:"mb-1"},i.createElement("strong",null,p.jy[p.WB.ACCOUNT_GROUP],":")," ",e.accountGroup)}},{key:"getTransactionAccount",value:function(e){return e.accountGroup&&i.createElement("div",{className:"mb-1"},i.createElement("strong",null,p.jy[p.WB.ACCOUNT_ID],":")," ",e.accountName)}},{key:"getTransactionAmount",value:function(e){return i.createElement("div",{className:"mb-1"},i.createElement("strong",null,p.jy[p.WB.AMOUNT],": "),i.createElement("span",{className:"badge bg-"+this.getTransactionTypeBg(e.transactionType)},"₹",e[p.WB.AMOUNT]))}},{key:"getTransactionDescription",value:function(e){return i.createElement("div",{className:"mb-1"},i.createElement("strong",null,p.jy[p.WB.DESCRIPTION],":")," ",e[p.WB.DESCRIPTION])}},{key:"getTransactionsCountLabel",value:function(e){return i.createElement("div",{className:"mt-2 d-flex justify-content-center"},i.createElement("span",{className:"text-muted"},"Showing ",e.length," of ",this.props.transactions.length," transactions."))}},{key:"getDraftActions",value:function(e){return this.props.isDraft&&this.props.transactions.length>0&&i.createElement("div",{className:"mb-2 d-flex justify-content-center"},i.createElement("button",{className:"btn btn-primary me-2",onClick:this.saveDrafts},"Save All"),i.createElement("button",{className:"btn btn-danger",onClick:this.deleteDrafts},"Delete All"))}},{key:"getTransactions",value:function(e){return this.props.transactions.length>0&&i.createElement("div",null,this.getTransactionsCountLabel(e),i.createElement(g,{transactions:e}),this.getDraftActions(e),i.createElement("div",{className:"row"},e.map(this.getTransaction)),this.getDraftActions(e))}},{key:"getAddButton",value:function(){var e=this;return i.createElement("button",{className:"btn btn-primary rounded-circle position-fixed bottom-0 end-0 m-4",onClick:function(){return e.toggleTransactionModal()},style:{width:"50px",height:"50px"}},"+")}},{key:"render",value:function(){var e=this.props.filteredTransactions;return i.createElement("div",{className:"mb-2"},this.getTransactions(e),this.getAddButton(),this.getCrudRuleModal(),this.getCrudTransactionModal())}}])}(i.Component);const B=(0,u.Ng)((function(e){return k.pick(e.user,["accountsMap","rulesMap"])}))(R)},5474:(e,t,n)=>{n.d(t,{E5:()=>r,Tv:()=>i,WB:()=>s,_Y:()=>o,jy:()=>c,t2:()=>l});var a=n(4467),r="681626859343-dtkml0ds42u48qg1q5nr07kevma99tfk.apps.googleusercontent.com",o={bank:"Bank",cash:"Cash",credit_card:"Credit Card"},s={DATE:"date",ACCOUNT_GROUP:"accountGroup",ACCOUNT_ID:"accountId",DESCRIPTION:"description",TYPE:"transactionType",AMOUNT:"amount",DEBIT:"debit",CREDIT:"credit",BALANCE:"balance"},c=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},s.DATE,"Date"),s.ACCOUNT_GROUP,"Account Group"),s.ACCOUNT_ID,"Account"),s.TYPE,"Transaction Type"),s.AMOUNT,"Amount"),s.DESCRIPTION,"Description"),l={DEBIT:"DEBIT",CREDIT:"CREDIT"},i={HDFC_AS_XLS_V1:"HDFC - XLS - V1",SBI_AS_XLS_V1:"SBI - XLS - V1",AXIS_AS_PDF_V1:"AXIS - PDF - V1"}},8736:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(4297);const r={extract:function(e,t,n){var r=new FormData;return r.append("accountId",e),r.append("extractor",t),r.append("file",n),a.A.post("/api/v1/transactions/extract",r,{"Content-Type":"multipart/form-data"})},saveDrafts:function(){return a.A.post("/api/v1/transactions/save-drafts")},deleteDrafts:function(){return a.A.post("/api/v1/transactions/delete-drafts")},getAll:function(e,t,n){return a.A.get("/api/v1/transactions",{startDate:e,endDate:t,isDraft:n})},upsert:function(e){return a.A.post("/api/v1/transaction",e)},delete:function(e){return a.A.delete("/api/v1/transaction/".concat(e))}}}}]);