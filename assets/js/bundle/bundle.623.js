"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[623],{5004:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var n=a(467),c=a(3029),s=a(2901),r=a(4441),l=a(3954),o=a(5501),i=a(4467),u=a(4756),d=a.n(u),m=a(6540),f=a(378),h=a(5474),v=a(3256),p=a(8573),E=a(8736),A=a(2543);function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var g=function(e){function t(){var e,a,s,o;(0,c.A)(this,t);for(var u=arguments.length,m=new Array(u),v=0;v<u;v++)m[v]=arguments[v];return a=this,s=t,o=[].concat(m),s=(0,l.A)(s),e=(0,r.A)(a,x()?Reflect.construct(s,o||[],(0,l.A)(a).constructor):s.apply(a,o)),(0,i.A)(e,"state",{selectedExtractor:A.keys(h.Tv)[0],selectedFile:null,transactions:[],extractionStatus:!1,extracted:0,selectedAccount:"",accounts:[]}),(0,i.A)(e,"handleExtractorChange",(function(t){e.setState({selectedExtractor:t.target.value,transactions:[],extracted:0})})),(0,i.A)(e,"handleFileUpload",function(){var t=(0,n.A)(d().mark((function t(a){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.target.files[0]){t.next=3;break}return t.abrupt("return",e.setState({selectedFile:null,transactions:[],extracted:0}));case 3:e.setState({selectedFile:n,transactions:[],extracted:0});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,i.A)(e,"getTransactions",(function(){if(!e.state.selectedFile)return f.oR.warn("Please select a file");e.setState({extractionStatus:!0,extracted:0}),E.A.extract(e.state.selectedExtractor,e.state.selectedFile).then((function(t){e.setState({transactions:t.processed_transactions,extractionStatus:!1,extracted:1})})).catch((function(t){e.setState({transactions:[],extractionStatus:!1,extracted:0}),f.oR.error(t.message)}))})),(0,i.A)(e,"updateTransaction",(function(t,a){e.state.transactions[a]=A.assign(e.state.transactions[a],t)})),(0,i.A)(e,"deleteTransaction",(function(t,a){e.state.transactions.splice(a,1)})),(0,i.A)(e,"handleAccountChange",(function(t){e.setState({selectedAccount:t.target.value})})),(0,i.A)(e,"bulkSave",(function(){E.A.bulkSave(e.state.selectedAccount,e.state.transactions)})),(0,i.A)(e,"getAccounts",(function(){p.A.getAll().then((function(t){return e.setState({accounts:t.accounts})}))})),e}return(0,o.A)(t,e),(0,s.A)(t,[{key:"getUploadCard",value:function(){return m.createElement("div",{className:"p-3 shadow mb-3"},m.createElement("h3",{className:"mb-3"},"Upload Statement"),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Select Extractor"),m.createElement("select",{className:"form-select",value:this.state.selectedExtractor,onChange:this.handleExtractorChange},A.keys(h.Tv).map((function(e,t){return m.createElement("option",{key:t,value:e},h.Tv[e])})))),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Upload File"),m.createElement("input",{type:"file",className:"form-control",onChange:this.handleFileUpload})),m.createElement("div",null,m.createElement("button",{className:"btn btn-primary",onClick:this.getTransactions},"Extract")))}},{key:"showTransactions",value:function(){var e=this.state.transactions;return 0==e.length?this.state.extractionStatus?m.createElement("div",{className:"mt-4 d-flex justify-content-center"},m.createElement("div",{className:"spinner-border text-primary text-center",role:"status"},m.createElement("span",{className:"visually-hidden"},"Loading..."))):this.state.extracted?m.createElement("div",{className:"mt-4 alert alert-danger"},"No transactions found"):void 0:m.createElement(v.A,{transactions:e,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction})}},{key:"getBulkSaveCard",value:function(){var e=this.state,t=e.selectedAccount,a=e.accounts,n=e.transactions;if(!A.isEmpty(n))return m.createElement("div",{className:"p-3 shadow-lg"},m.createElement("div",{className:"mb-3"},m.createElement("select",{className:"form-select",value:t,onChange:this.handleAccountChange},m.createElement("option",{value:""},"Select Account"),a.map((function(e,t){return m.createElement("option",{key:t,value:e._id},e.name)})))),m.createElement("div",null,m.createElement("button",{className:"btn btn-primary",disabled:A.isEmpty(t),onClick:this.bulkSave},"Bulk Save")))}},{key:"render",value:function(){return m.createElement("div",{className:"mb-3"},this.getUploadCard(),this.showTransactions(),this.getBulkSaveCard())}},{key:"componentDidMount",value:function(){this.getAccounts()}}])}(m.Component)}}]);