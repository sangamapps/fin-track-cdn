"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[126],{448:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(3029),r=n(2901),o=n(4441),l=n(3954),s=n(5501),c=n(6540),i=n(6634);function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}var m=function(e){function t(){return(0,a.A)(this,t),e=this,n=t,r=arguments,n=(0,l.A)(n),(0,o.A)(e,u()?Reflect.construct(n,r||[],(0,l.A)(e).constructor):n.apply(e,r));var e,n,r}return(0,s.A)(t,e),(0,r.A)(t,[{key:"getModalTitle",value:function(){return c.createElement("h5",{className:"modal-title"},this.props.title)}},{key:"getCloseButton",value:function(){return c.createElement("button",{type:"button",className:"btn-close",onClick:this.props.onClose})}},{key:"getModalHeader",value:function(){return c.createElement("div",{className:"modal-header"},this.getModalTitle(),this.getCloseButton())}},{key:"getModalBody",value:function(){var e=this.props.body;return e&&c.createElement("div",{className:"modal-body"},e)}},{key:"getCancelButton",value:function(){return c.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.props.onClose},"Cancel")}},{key:"getSubmitButton",value:function(){return c.createElement("button",{type:"submit",className:"btn btn-dark",onClick:this.props.onSubmitClick},"Submit")}},{key:"getModalFooter",value:function(){return c.createElement("div",{className:"modal-footer"},this.getCancelButton(),this.getSubmitButton())}},{key:"render",value:function(){return c.createElement(i.A,{in:this.props.show,timeout:490,classNames:"modal-container",unmountOnExit:!0},c.createElement("div",null,c.createElement("div",{className:"modal-backdrop fade show"}),c.createElement("div",{className:"modal fade show d-block"},c.createElement("div",{className:"modal-dialog"},c.createElement("div",{className:"modal-content"},this.getModalHeader(),this.getModalBody(),this.getModalFooter())))))}}])}(c.Component)},756:(e,t,n)=>{n.d(t,{A:()=>v});var a=n(3029),r=n(2901),o=n(4441),l=n(3954),s=n(5501),c=n(4467),i=n(6540),u=n(1225),m=n(378),d=n(448),p=n(3908);function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(f=function(){return!!e})()}function h(e){var t,n,a,r;return{_id:(null===(t=e.rule)||void 0===t?void 0:t._id)||"",tag:(null===(n=e.rule)||void 0===n?void 0:n.tag)||"",keywords:(null===(a=e.rule)||void 0===a?void 0:a.keywords)||"",description:(null===(r=e.rule)||void 0===r?void 0:r.description)||""}}var g=function(e){function t(e){var n,r,s,u;return(0,a.A)(this,t),r=this,s=t,u=[e],s=(0,l.A)(s),n=(0,o.A)(r,f()?Reflect.construct(s,u||[],(0,l.A)(r).constructor):s.apply(r,u)),(0,c.A)(n,"handleChange",(function(e){n.setState((0,c.A)({},e.target.name,e.target.value))})),(0,c.A)(n,"handleSubmit",(function(e){e.preventDefault(),n.state.tag=n.state.tag||n.state.name,n.props.dispatch((0,p.Pv)(n.state)).then((function(e){m.oR.info("Rule saved ✅"),(n.props.onSave||n.props.onClose||function(){})(e.payload)}))})),(0,c.A)(n,"onSubmitClick",(function(){n.formRef.current&&n.formRef.current.requestSubmit()})),n.state=h(e),n.formRef=i.createRef(),n}return(0,s.A)(t,e),(0,r.A)(t,[{key:"componentDidUpdate",value:function(e){e.rule!==this.props.rule&&this.setState(h(this.props))}},{key:"getModalTitle",value:function(){var e;return null!==(e=this.props.rule)&&void 0!==e&&e._id?"Edit Rule":"Add Rule"}},{key:"getModalBody",value:function(){var e=this.state,t=e.name,n=e.keywords,a=e.tag;return i.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Tag"),i.createElement("input",{type:"text",className:"form-control",name:"tag",value:a||t,onChange:this.handleChange,placeholder:"Tag",required:!0})),i.createElement("div",{className:"mb-2"},i.createElement("label",{className:"form-label"},"Keywords"),i.createElement("textarea",{className:"form-control",name:"keywords",value:n,onChange:this.handleChange,placeholder:"Keywords (eg: Keyword1, Keyword2)",required:!0})))}},{key:"render",value:function(){return i.createElement(d.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(i.Component);const v=(0,u.Ng)()(g)},5370:(e,t,n)=>{n.d(t,{A:()=>a});const a={getFormattedAmount:function(e){return e.toLocaleString("en-IN",{minimumFractionDigits:2})}}},5474:(e,t,n)=>{n.d(t,{$7:()=>s,E5:()=>a,Z0:()=>r,t2:()=>l,tP:()=>o,wc:()=>c});var a="681626859343-dtkml0ds42u48qg1q5nr07kevma99tfk.apps.googleusercontent.com",r={bank:"Bank",cash:"Cash",credit_card:"Credit Card",stocks:"Stocks",others:"Others"},o={DATE:"Date",ACCOUNT:"Account",TYPE:"Transaction Type",AMOUNT:"Amount",DESCRIPTION:"Description",COMMENTS:"Comments"},l={DEBIT:"DEBIT",CREDIT:"CREDIT"},s={DEBIT:"Debit",CREDIT:"Credit"},c={HDFC_AS_XLS_V1:"HDFC - XLS - V1",SBI_AS_XLS_V1:"SBI - XLS - V1",AXIS_AS_PDF_V1:"AXIS - PDF - V1"}},8736:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(4297);const r={extract:function(e,t,n){var r=new FormData;return r.append("accountId",e),r.append("extractor",t),r.append("file",n),a.A.post("/api/v1/transactions/extract",r,{"Content-Type":"multipart/form-data"})},saveDrafts:function(){return a.A.post("/api/v1/transactions/save-drafts")},deleteDrafts:function(){return a.A.post("/api/v1/transactions/delete-drafts")},getAll:function(e,t,n,r){return a.A.get("/api/v1/transactions",{startDate:e,endDate:t,isDraft:n,sortByDate:r})},upsert:function(e){return a.A.post("/api/v1/transaction",e)},delete:function(e){return a.A.delete("/api/v1/transaction/".concat(e))}}},8846:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(5474);const r={getTransactionTypeLabel:function(e){return a.$7[e]},getAccountLabel:function(e){return e.name+" ("+a.Z0[e.type]+")"}}},9126:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ee});var a=n(5458),r=n(3029),o=n(2901),l=n(4441),s=n(3954),c=n(5501),i=n(4467),u=n(6540),m=n(1225),d=n(378),p=n(8736),f=n(5474),h=n(8846),g=n(2543);function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var E=function(e){function t(){var e,n,a,o;(0,r.A)(this,t);for(var c=arguments.length,m=new Array(c),d=0;d<c;d++)m[d]=arguments[d];return n=this,a=t,o=[].concat(m),a=(0,s.A)(a),e=(0,l.A)(n,v()?Reflect.construct(a,o||[],(0,s.A)(n).constructor):a.apply(n,o)),(0,i.A)(e,"state",{showFiltersView:!1}),(0,i.A)(e,"handleFilterChange",(function(t){e.props.handleFilterChange(t.target.name,t.target.value)})),(0,i.A)(e,"getDateFilter",(function(){var t=e.props.filters;return u.createElement("div",{className:"mb-2"},u.createElement("div",{className:"input-group m-0"},u.createElement("span",{className:"input-group-text"},"From"),u.createElement("input",{type:"date",name:"startDateFilter",value:t.startDateFilter,className:"form-control",onChange:e.handleFilterChange}),u.createElement("span",{className:"input-group-text"},"To"),u.createElement("input",{type:"date",name:"endDateFilter",value:t.endDateFilter,className:"form-control",onChange:e.handleFilterChange}),u.createElement("button",{className:"btn btn-dark",onClick:function(){return e.props.resetDateFilter("startDateFilter","")}},u.createElement("i",{className:"bi bi-trash-fill"}))))})),e}return(0,c.A)(t,e),(0,o.A)(t,[{key:"toggleFiltersView",value:function(){this.setState({showFiltersView:!this.state.showFiltersView})}},{key:"getFilters",value:function(){var e=this;if(!this.state.showFiltersView)return this.getFiltersButton();var t=this.props,n=t.accountsMap,a=t.rulesMap,r=t.filters;return u.createElement("div",{className:"p-3 bg-dark rounded-end-1",style:{maxWidth:"500px"}},u.createElement("div",{className:"row"},u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Min"),u.createElement("input",{type:"number",name:"minAmountFilter",value:r.minAmountFilter,className:"form-control",onChange:this.handleFilterChange}),u.createElement("span",{className:"input-group-text"},"Max"),u.createElement("input",{type:"number",name:"maxAmountFilter",value:r.maxAmountFilter,className:"form-control",onChange:this.handleFilterChange}))),n&&u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Account Type"),u.createElement("select",{name:"accountTypeFilter",value:r.accountTypeFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),g.keys(g.groupBy(this.props.accountsMap,"type")).map((function(e,t){return u.createElement("option",{key:t,value:e},f.Z0[e])}))))),n&&u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Account"),u.createElement("select",{name:"accountIdFilter",value:r.accountIdFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),g.values(this.props.accountsMap).map((function(e,t){return u.createElement("option",{key:t,value:e._id},h.A.getAccountLabel(e))}))))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Transaction Type"),u.createElement("select",{name:"transactionTypeFilter",value:r.transactionTypeFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),u.createElement("option",{value:f.t2.DEBIT},"Debit"),u.createElement("option",{value:f.t2.CREDIT},"Credit")))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Tag"),u.createElement("select",{name:"tagFilter",value:r.tagFilter,className:"form-control",onChange:this.handleFilterChange},u.createElement("option",{value:""},"All"),u.createElement("option",{value:"__NONE__"},"Others"),g.values(a).map((function(e,t){return u.createElement("option",{key:t,value:e._id},e.tag)}))))),u.createElement("div",{className:"col-12 mb-2"},u.createElement("div",{className:"input-group"},u.createElement("span",{className:"input-group-text"},"Search"),u.createElement("input",{type:"search",name:"searchFilter",value:r.searchFilter,className:"form-control",onChange:this.handleFilterChange})))),u.createElement("button",{className:"btn btn-secondary me-2",onClick:function(){return e.toggleFiltersView()}},u.createElement("i",{className:"bi bi-x-lg"})),u.createElement("button",{className:"btn btn-secondary me-2",onClick:this.props.resetFilters},u.createElement("i",{className:"bi bi-trash-fill"})))}},{key:"getFiltersButton",value:function(){var e=this;return u.createElement("button",{className:"btn btn-dark rounded-circle m-2",onClick:function(){return e.toggleFiltersView()},style:{width:"50px",height:"50px"}},u.createElement("i",{className:"bi bi-funnel-fill"}))}},{key:"render",value:function(){return u.createElement("div",{className:""},this.getDateFilter(),u.createElement("div",{className:"position-fixed z-1 bottom-0 start-0"},this.getFilters()))}}])}(u.Component);const y=(0,m.Ng)((function(e){return g.pick(e.user,["accountsMap","rulesMap"])}))(E);var b=n(5370),A=n(2543);function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(N=function(){return!!e})()}var T=function(e){function t(){return(0,r.A)(this,t),e=this,n=t,a=arguments,n=(0,s.A)(n),(0,l.A)(e,N()?Reflect.construct(n,a||[],(0,s.A)(e).constructor):n.apply(e,a));var e,n,a}return(0,c.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this.props,t=e.transactions,n=e.accounts;if(A.isEmpty(t)||A.isEmpty(n))return u.createElement(u.Fragment,null);var a=A.uniq(t.map((function(e){return e.accountId}))),r=n.filter((function(e){return a.includes(e._id||e.id)&&!e.type.includes("others")})).map((function(e){var n=e._id||e.id,a=e.openingBalance||0,r=t.filter((function(e){return e.accountId===n})),o=A.groupBy(r,"type"),l=A.sumBy(o[f.t2.DEBIT],(function(e){return e.amount})),s=A.sumBy(o[f.t2.CREDIT],(function(e){return e.amount})),c=a+s-l;return{name:e.name,type:e.type,openingBalance:a,totalDebit:l,totalCredit:s,closingBalance:c}})),o={openingBalance:A.sumBy(r,"openingBalance"),totalDebit:A.sumBy(r,"totalDebit"),totalCredit:A.sumBy(r,"totalCredit")};return o.closingBalance=o.openingBalance+o.totalCredit-o.totalDebit,u.createElement("div",{className:"mt-4"},u.createElement("h4",{className:"mb-3"},"Summary"),u.createElement("div",{className:"table-responsive"},u.createElement("table",{className:"table table-bordered table-striped text-center shadow-sm"},u.createElement("thead",{className:"table-light"},u.createElement("tr",null,u.createElement("th",null,"Account"),u.createElement("th",null,"Opening Balance (₹)"),u.createElement("th",null,"Total Debit (₹)"),u.createElement("th",null,"Total Credit (₹)"),u.createElement("th",null,"Closing Balance (₹)"))),u.createElement("tbody",null,r.map((function(e,t){return u.createElement("tr",{key:t},u.createElement("td",null,h.A.getAccountLabel(e)),u.createElement("td",{className:"text-muted"},b.A.getFormattedAmount(e.openingBalance)),u.createElement("td",{className:"text-danger"},b.A.getFormattedAmount(e.totalDebit)),u.createElement("td",{className:"text-success"},b.A.getFormattedAmount(e.totalCredit)),u.createElement("td",{className:"fw-bold"},b.A.getFormattedAmount(e.closingBalance)))})),u.createElement("tr",{className:"table-secondary fw-bold"},u.createElement("td",null,"Total"),u.createElement("td",null,b.A.getFormattedAmount(o.openingBalance)),u.createElement("td",null,b.A.getFormattedAmount(o.totalDebit)),u.createElement("td",null,b.A.getFormattedAmount(o.totalCredit)),u.createElement("td",null,b.A.getFormattedAmount(o.closingBalance)))))))}}])}(u.Component),F=n(756),C=n(448),D=n(5093),k=n(2543);function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}function B(e){var t,n,a,r,o,l,s,c,i;return{_id:(null===(t=e.transaction)||void 0===t?void 0:t._id)||"",date:(null===(n=e.transaction)||void 0===n?void 0:n.date)||D().format("YYYY-MM-DD"),type:(null===(a=e.transaction)||void 0===a?void 0:a.type)||f.t2.DEBIT,accountId:(null===(r=e.transaction)||void 0===r?void 0:r.accountId)||"",amount:(null===(o=e.transaction)||void 0===o?void 0:o.amount)||0,balance:(null===(l=e.transaction)||void 0===l?void 0:l.balance)||0,description:(null===(s=e.transaction)||void 0===s?void 0:s.description)||"",appliedRules:(null===(c=e.transaction)||void 0===c?void 0:c.appliedRules)||{},comments:(null===(i=e.transaction)||void 0===i?void 0:i.comments)||"",isDraft:e.isDraft}}var S=function(e){function t(e){var n,a,o,c;return(0,r.A)(this,t),a=this,o=t,c=[e],o=(0,s.A)(o),n=(0,l.A)(a,w()?Reflect.construct(o,c||[],(0,s.A)(a).constructor):o.apply(a,c)),(0,i.A)(n,"handleChange",(function(e){n.setState((0,i.A)({},e.target.name,e.target.value))})),(0,i.A)(n,"handleSubmit",(function(e){e.preventDefault(),n.state.amount=parseFloat(n.state.amount),p.A.upsert(n.state).then((function(e){d.oR.info("Transaction saved ✅"),n.props.onSave(e.transaction)}))})),(0,i.A)(n,"onSubmitClick",(function(){n.formRef.current&&n.formRef.current.requestSubmit()})),n.state=B(e),n.formRef=u.createRef(),n}return(0,c.A)(t,e),(0,o.A)(t,[{key:"componentDidUpdate",value:function(e){e.transaction!==this.props.transaction&&this.setState(B(this.props))}},{key:"getModalTitle",value:function(){return this.props.transaction?"Edit Transaction":"Add Transaction"}},{key:"getModalBody",value:function(){var e=this.state,t=e.date,n=e.description,a=e.accountId,r=e.type,o=e.amount,l=e.comments,s=this.props.accountsMap;return u.createElement("form",{ref:this.formRef,onSubmit:this.handleSubmit},u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Date"),u.createElement("input",{type:"date",className:"form-control",name:"date",value:t,onChange:this.handleChange,required:!0})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Transaction Type"),u.createElement("select",{className:"form-select",name:"type",value:r,onChange:this.handleChange,required:!0},u.createElement("option",{value:""}),u.createElement("option",{value:"DEBIT"},"Debit"),u.createElement("option",{value:"CREDIT"},"Credit"))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Account"),u.createElement("select",{className:"form-select",name:"accountId",value:a,onChange:this.handleChange,required:!0},u.createElement("option",{value:""}),k.values(s).map((function(e,t){return u.createElement("option",{key:t,value:e._id},h.A.getAccountLabel(e))})))),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Amount"),u.createElement("input",{type:"number",className:"form-control",name:"amount",value:o,onChange:this.handleChange,required:!0})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Description"),u.createElement("input",{type:"text",className:"form-control",name:"description",value:n,onChange:this.handleChange})),u.createElement("div",{className:"mb-2"},u.createElement("label",{className:"form-label"},"Comments"),u.createElement("textarea",{className:"form-control",name:"comments",value:l,onChange:this.handleChange})))}},{key:"render",value:function(){return u.createElement(C.A,{show:this.props.show,title:this.getModalTitle(),body:this.getModalBody(),onClose:this.props.onClose,onSubmitClick:this.onSubmitClick})}}])}(u.Component);const M=(0,m.Ng)((function(e){return k.pick(e.user,["accountsMap"])}))(S);var R=n(8168),x=n(9097),I=(n(4773),n(3908)),O=n(2543);function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}var L=[{component:function(){return n.e(627).then(n.bind(n,6627))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{component:function(){return n.e(827).then(n.bind(n,8827))},className:"col-sm-12 col-md-6 col-lg-4 mb-3",props:{transactionType:"DEBIT"}},{component:function(){return n.e(827).then(n.bind(n,8827))},className:"col-sm-12 col-md-6 col-lg-4 mb-3",props:{transactionType:"CREDIT"}},{component:function(){return n.e(510).then(n.bind(n,5510))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{component:function(){return n.e(646).then(n.bind(n,6646))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{component:function(){return n.e(98).then(n.bind(n,7098))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{component:function(){return n.e(42).then(n.bind(n,8042))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"},{component:function(){return n.e(446).then(n.bind(n,4446))},className:"col-sm-12 col-md-6 col-lg-4 mb-3"}],P=function(e){function t(){var e,n,a,o;(0,r.A)(this,t);for(var c=arguments.length,u=new Array(c),m=0;m<c;m++)u[m]=arguments[m];return n=this,a=t,o=[].concat(u),a=(0,s.A)(a),e=(0,l.A)(n,_()?Reflect.construct(a,o||[],(0,s.A)(n).constructor):a.apply(n,o)),(0,i.A)(e,"state",{showStatsView:!0}),(0,i.A)(e,"handleChange",(function(t){e.props.dispatch((0,I.B0)(t.target.value))})),e}return(0,c.A)(t,e),(0,o.A)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.statsGroupByPeriod,a=t.filteredTransactions;return 0==a.length?u.createElement(u.Fragment,null):u.createElement("div",{className:""},u.createElement("div",{className:"mb-2 d-flex align-items-center"},u.createElement("h3",null,"Stats"),u.createElement("select",{className:"form-select w-auto ms-auto me-2",value:n,onChange:this.handleChange},u.createElement("option",{value:"daily"},"Daily"),u.createElement("option",{value:"weekly"},"Weekly"),u.createElement("option",{value:"monthly"},"Monthly"),u.createElement("option",{value:"yearly"},"Yearly"),u.createElement("option",{value:"overall"},"Overall")),u.createElement("button",{className:"btn btn-dark",onClick:function(){return e.setState({showStatsView:!e.state.showStatsView})}},this.state.showStatsView?u.createElement("i",{className:"bi bi-eye-slash-fill"}):u.createElement("i",{className:"bi bi-eye-fill"}))),this.state.showStatsView&&u.createElement("div",{className:"row"},L.map((function(e,t){return u.createElement("div",{key:t,className:e.className},u.createElement(x.A,(0,R.A)({component:e.component,timeFilter:n,filteredTransactions:a},e.props)))}))))}}])}(u.Component);const V=(0,m.Ng)((function(e){return O.pick(e.user,["statsGroupByPeriod"])}))(P);var j=n(5093),Y=n(2543);function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}var U=function(e){function t(){var e,n,a,o;(0,r.A)(this,t);for(var c=arguments.length,m=new Array(c),f=0;f<c;f++)m[f]=arguments[f];return n=this,a=t,o=[].concat(m),a=(0,s.A)(a),e=(0,l.A)(n,q()?Reflect.construct(a,o||[],(0,s.A)(n).constructor):a.apply(n,o)),(0,i.A)(e,"state",{showRulesModal:!1,showTransactionModal:!1,selectedTransaction:null}),(0,i.A)(e,"toggleRulesModal",(function(t){e.setState({showRulesModal:!e.state.showRulesModal,selectedTransaction:t})})),(0,i.A)(e,"handleRuleSave",(function(t){e.toggleRulesModal()})),(0,i.A)(e,"toggleTransactionModal",(function(t){e.setState({showTransactionModal:!e.state.showTransactionModal,selectedTransaction:t})})),(0,i.A)(e,"getTransaction",(function(t,n){return u.createElement("div",{key:n,className:"col-md-6 col-lg-4 mb-2"},u.createElement("div",{className:"card shadow-sm"},u.createElement("div",{className:"card-body"},e.getTags(t),e.getTransactionDate(t),e.getTransactionAccount(t),e.getTransactionAmount(t),e.getTransactionDescription(t),e.getTransactionComments(t))))})),(0,i.A)(e,"saveDrafts",(function(){p.A.saveDrafts().then((function(){d.oR.info("Draft transactions saved ✅"),e.props.fetchTransactions()}))})),(0,i.A)(e,"deleteDrafts",(function(){p.A.deleteDrafts().then((function(){d.oR.info("Draft transactions deleted ✅"),e.props.fetchTransactions()}))})),e}return(0,c.A)(t,e),(0,o.A)(t,[{key:"getCrudRuleModal",value:function(){var e=this,t=this.state,n=t.showRulesModal,a=t.selectedTransaction;return u.createElement(F.A,{show:n,rule:{contains:null==a?void 0:a.description},onSave:this.handleRuleSave,onClose:function(){return e.toggleRulesModal()}})}},{key:"getCrudTransactionModal",value:function(){var e=this,t=this.state,n=t.showTransactionModal,a=t.selectedTransaction;return u.createElement(M,{show:n,transaction:a,onSave:this.props.updateTransaction,isDraft:this.props.isDraft,onClose:function(){return e.toggleTransactionModal()}})}},{key:"removeTransactionTag",value:function(e,t){e.appliedRules[t]=0,p.A.upsert(e).then(this.props.updateTransaction)}},{key:"getDefaultTag",value:function(e,t){return u.createElement("span",{className:"badge bg-"+t+" mb-2 me-1"},e)}},{key:"getTag",value:function(e,t){var n,a=this,r=this.props.rulesMap;return u.createElement("div",{key:t,className:"badge bg-primary mb-2 me-1"},null===(n=r[t])||void 0===n?void 0:n.tag,u.createElement("span",{className:"ms-1 cursor-pointer",onClick:function(){return a.removeTransactionTag(e,t)}},"×"))}},{key:"getTransactionTypeBg",value:function(e){return e==f.t2.CREDIT?"success":"danger"}},{key:"getTags",value:function(e){var t=this,n=Y.keys(Y.pickBy(e.appliedRules,(function(e){return 1==e})));return u.createElement("div",{className:"d-flex "},u.createElement("div",{className:"d-flex flex-wrap"},this.getDefaultTag(e.type,this.getTransactionTypeBg(e.type)),0==n.length&&this.getDefaultTag("Others","dark"),n.map((function(n){return t.getTag(e,n)}))),u.createElement("div",{className:"ms-auto d-flex flex-wrap justify-content-end"},u.createElement("span",{className:"badge bg-secondary mb-2 me-1 cursor-pointer",onClick:function(){return t.toggleRulesModal(e)}},"+"),u.createElement("span",{className:"badge bg-secondary cursor-pointer mb-2 me-1",onClick:function(){return t.toggleTransactionModal(e)}},u.createElement("i",{className:"bi bi-pencil"})),u.createElement("span",{className:"badge bg-secondary cursor-pointer mb-2 me-1",onClick:function(){return t.props.deleteTransaction(e)}},u.createElement("i",{className:"bi bi-trash"}))))}},{key:"getTransactionDate",value:function(e){return u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.DATE,":")," ",(t=e.date,j(t,"YYYY-MM-DD")).format("MMMM D, YYYY (dddd)"));var t}},{key:"getTransactionAccount",value:function(e){return e.account&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.ACCOUNT_ID,":")," ",h.A.getAccountLabel(e.account))}},{key:"getTransactionAmount",value:function(e){return u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.ACCOUNT,": "),u.createElement("span",{className:"badge bg-"+this.getTransactionTypeBg(e.type)},"₹",b.A.getFormattedAmount(e.amount)))}},{key:"getTransactionDescription",value:function(e){var t=e.description;return!Y.isEmpty(t)&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.DESCRIPTION,":")," ",t)}},{key:"getTransactionComments",value:function(e){var t=e.comments;return!Y.isEmpty(t)&&u.createElement("div",{className:"mb-1"},u.createElement("strong",null,f.tP.COMMENTS,":")," ",t)}},{key:"getTransactionsCountLabel",value:function(e){return u.createElement("div",{className:"d-flex justify-content-center"},u.createElement("span",{className:"text-muted"},"Showing ",e.length," of ",this.props.transactions.length," transactions."))}},{key:"getDraftActions",value:function(e){return this.props.isDraft&&this.props.transactions.length>0&&u.createElement("div",{className:"mt-2 d-flex justify-content-center"},u.createElement("button",{className:"btn btn-primary me-2",onClick:this.saveDrafts},"Save All"),u.createElement("button",{className:"btn btn-danger",onClick:this.deleteDrafts},"Delete All"))}},{key:"getTransactions",value:function(e){return this.props.transactions.length>0&&u.createElement("div",null,u.createElement(V,{filteredTransactions:e}),u.createElement(T,{transactions:e,accounts:this.props.accounts}),this.getTransactionsCountLabel(e),this.getDraftActions(e),u.createElement("div",{className:"row mt-2"},e.slice().reverse().map(this.getTransaction)),this.getDraftActions(e))}},{key:"getAddButton",value:function(){var e=this;return u.createElement("button",{className:"btn btn-dark rounded-circle position-fixed bottom-0 end-0 m-2",onClick:function(){return e.toggleTransactionModal()},style:{width:"50px",height:"50px"}},u.createElement("i",{className:"bi bi-database-fill-add"}))}},{key:"render",value:function(){var e=this.props.filteredTransactions;return u.createElement("div",{className:"mb-2"},this.getTransactions(e),this.getAddButton(),this.getCrudRuleModal(),this.getCrudTransactionModal())}}])}(u.Component);const X=(0,m.Ng)((function(e){return Y.pick(e.user,["accountsMap","accounts","rulesMap"])}))(U);var H=n(2543);var K=n(2543);const Z=function(e,t,n,a){return K.filter(e,(function(e){if(!K.isEmpty(t.minAmountFilter)&&e.amount<t.minAmountFilter)return!1;if(!K.isEmpty(t.maxAmountFilter)&&e.amount>t.maxAmountFilter)return!1;var r=n&&n[e.accountId]||{};if(e.account=r,!K.isEmpty(t.accountTypeFilter)&&r.type!=t.accountTypeFilter)return!1;if(!K.isEmpty(t.accountIdFilter)&&e.accountId!=t.accountIdFilter)return!1;if(!K.isEmpty(t.transactionTypeFilter)&&e.type!=t.transactionTypeFilter)return!1;if(function(e,t){var n=[];t.forEach((function(t){var a=t._id,r=t.keywords,o=t.tag;if(e.appliedRules=e.appliedRules||{},0!=e.appliedRules[a]){var l=H.toLower(e.description);H.some(H.split(H.toLower(r),","),(function(e){return l.includes(H.trim(e))}))&&(e.appliedRules[a]=1,n.push(o))}})),e.tags=n}(e,a),!K.isEmpty(t.tagFilter))if("__NONE__"==t.tagFilter){if(e.tags.length>0)return!1}else if(!e.appliedRules[t.tagFilter])return!1;return!(!K.isEmpty(t.searchFilter)&&!K.includes(K.toLower(e.description),K.toLower(t.searchFilter)))}))};var G=n(3632),W=n(2543);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(J=function(){return!!e})()}var Q=function(e){function t(){var e,n,o,c;(0,r.A)(this,t);for(var u=arguments.length,m=new Array(u),f=0;f<u;f++)m[f]=arguments[f];return n=this,o=t,c=[].concat(m),o=(0,s.A)(o),e=(0,l.A)(n,J()?Reflect.construct(o,c||[],(0,s.A)(n).constructor):o.apply(n,c)),(0,i.A)(e,"state",z(z(z({},e.getInitialDateFilters()),e.getInitialFilters()),{},{transactions:[],transactionsLoading:!1})),(0,i.A)(e,"handleDateFilterChange",(function(t,n){e.setState((0,i.A)({},t,n),e.fetchTransactions)})),(0,i.A)(e,"resetDateFilter",(function(){e.setState(e.getInitialDateFilters(),e.fetchTransactions)})),(0,i.A)(e,"handleFilterChange",(function(t,n){e.setState((0,i.A)({},t,n),(function(){"startDateFilter"!=t&&"endDateFilter"!=t||e.fetchTransactions()}))})),(0,i.A)(e,"resetFilters",(function(){e.setState(e.getInitialFilters())})),(0,i.A)(e,"updateTransaction",(function(t){e.setState((function(e){var n=(0,a.A)(e.transactions),r=W.findIndex(n,(function(e){return e._id===t._id}));return r>=0?n[r]=t:n.push(t),{transactions:n,showTransactionModal:!1}}))})),(0,i.A)(e,"deleteTransaction",(function(t){p.A.delete(t._id).then((function(t){e.setState((function(e){return{transactions:e.transactions.filter((function(e){return e._id!==t._id}))}}),(function(){return d.oR.info("Transaction deleted ✅")}))}))})),(0,i.A)(e,"fetchTransactions",(function(){e.setState({transactions:[],transactionsLoading:!0}),p.A.getAll(e.state.startDateFilter,e.state.endDateFilter,e.props.isDraft,e.props.sortByDate).then((function(t){e.setState({transactions:t.transactions,transactionsLoading:!1})}))})),e}return(0,c.A)(t,e),(0,o.A)(t,[{key:"getInitialDateFilters",value:function(){return{startDateFilter:this.props.startDateFilter||"",endDateFilter:this.props.endDateFilter||""}}},{key:"getFilters",value:function(){return{startDateFilter:this.state.startDateFilter,endDateFilter:this.state.endDateFilter,minAmountFilter:this.state.minAmountFilter,maxAmountFilter:this.state.maxAmountFilter,accountTypeFilter:this.state.accountTypeFilter,accountIdFilter:this.state.accountIdFilter,transactionTypeFilter:this.state.transactionTypeFilter,tagFilter:this.state.tagFilter,searchFilter:this.state.searchFilter}}},{key:"getInitialFilters",value:function(){return{minAmountFilter:"",maxAmountFilter:"",accountTypeFilter:"",accountIdFilter:"",transactionTypeFilter:"",tagFilter:"",searchFilter:""}}},{key:"getFiltersView",value:function(){return u.createElement(y,{filters:this.getFilters(),handleFilterChange:this.handleFilterChange,resetFilters:this.resetFilters,resetDateFilter:this.resetDateFilter})}},{key:"getNoTransactionsLabel",value:function(){return this.props.isDraft?u.createElement("div",{className:"text-muted"},"No drafts transactions found."):u.createElement("div",{className:"text-muted"},"No transactions found.")}},{key:"getLoader",value:function(){return this.state.transactionsLoading?G.A.spinnerLoader("mt-3"):0==this.state.transactions.length?u.createElement("div",{className:"mt-3 mb-3 text-center"},this.getNoTransactionsLabel()):void 0}},{key:"getFilteredTransactions",value:function(){return Z(this.state.transactions,this.getFilters(),this.props.accountsMap,this.props.rules)}},{key:"getLayoutBody",value:function(){var e=this.getFilteredTransactions();return u.createElement(X,{isDraft:this.props.isDraft,transactions:this.state.transactions,filteredTransactions:e,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction,fetchTransactions:this.fetchTransactions})}},{key:"render",value:function(){return u.createElement("div",{className:""},this.getFiltersView(),this.getLoader(),this.getLayoutBody())}},{key:"componentDidMount",value:function(){this.fetchTransactions()}}])}(u.Component);const ee=(0,m.Ng)((function(e){return W.pick(e.user,["accountsMap","rules"])}))(Q)}}]);