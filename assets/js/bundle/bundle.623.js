"use strict";(self.webpackChunkfin_track_ui=self.webpackChunkfin_track_ui||[]).push([[623],{5004:(t,e,a)=>{a.r(e),a.d(e,{default:()=>x});var n=a(467),c=a(3029),s=a(2901),r=a(4441),l=a(3954),o=a(5501),i=a(4467),u=a(4756),d=a.n(u),m=a(6540),f=a(378),v=a(5474),h=a(3256),p=a(8573),A=a(8736),E=a(2543);function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}var x=function(t){function e(){var t,a,s,o;(0,c.A)(this,e);for(var u=arguments.length,m=new Array(u),h=0;h<u;h++)m[h]=arguments[h];return a=this,s=e,o=[].concat(m),s=(0,l.A)(s),t=(0,r.A)(a,g()?Reflect.construct(s,o||[],(0,l.A)(a).constructor):s.apply(a,o)),(0,i.A)(t,"state",{selectedExtractor:E.keys(v.Tv)[0],selectedFile:null,transactions:[],extractionStatus:!1,extracted:0,selectedAccount:"",accounts:[]}),(0,i.A)(t,"handleExtractorChange",(function(e){t.setState({selectedExtractor:e.target.value,transactions:[],extracted:0})})),(0,i.A)(t,"handleFileUpload",function(){var e=(0,n.A)(d().mark((function e(a){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.target.files[0]){e.next=3;break}return e.abrupt("return",t.setState({selectedFile:null,transactions:[],extracted:0}));case 3:t.setState({selectedFile:n,transactions:[],extracted:0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,i.A)(t,"getTransactions",(function(){if(!t.state.selectedFile)return f.oR.warn("Please select a file");t.setState({extractionStatus:!0,extracted:0}),A.A.extract(t.state.selectedExtractor,t.state.selectedFile).then((function(e){t.setState({transactions:e.processed_transactions,extractionStatus:!1,extracted:1})})).catch((function(e){t.setState({transactions:[],extractionStatus:!1,extracted:0}),f.oR.error(e.message)}))})),(0,i.A)(t,"updateTransaction",(function(e,a){t.state.transactions[a]=E.assign(t.state.transactions[a],e)})),(0,i.A)(t,"deleteTransaction",(function(e,a){t.state.transactions.splice(a,1)})),(0,i.A)(t,"handleAccountChange",(function(e){t.setState({selectedAccount:e.target.value})})),(0,i.A)(t,"bulkSave",(function(){A.A.bulkSave(t.state.selectedAccount,t.state.transactions)})),(0,i.A)(t,"getAccounts",(function(){p.A.getAll().then((function(e){return t.setState({accounts:e.accounts})}))})),t}return(0,o.A)(e,t),(0,s.A)(e,[{key:"getUploadCard",value:function(){return m.createElement("div",{className:"p-3 shadow mb-3"},m.createElement("h3",{className:"mb-3"},"Upload Statement"),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Select Extractor"),m.createElement("select",{className:"form-select",value:this.state.selectedExtractor,onChange:this.handleExtractorChange},E.keys(v.Tv).map((function(t,e){return m.createElement("option",{key:e,value:t},v.Tv[t])})))),m.createElement("div",{className:"mb-3"},m.createElement("label",{className:"form-label"},"Upload File"),m.createElement("input",{type:"file",className:"form-control",onChange:this.handleFileUpload})),m.createElement("div",null,m.createElement("button",{className:"btn btn-primary",onClick:this.getTransactions},"Extract")))}},{key:"showTransactions",value:function(){var t=this.state.transactions;return 0==t.length?this.state.extractionStatus?m.createElement("div",{className:"mt-4 d-flex justify-content-center"},m.createElement("div",{className:"spinner-border text-primary text-center",role:"status"},m.createElement("span",{className:"visually-hidden"},"Loading..."))):this.state.extracted?m.createElement("div",{className:"mt-4 alert alert-danger"},"No transactions found"):void 0:m.createElement(h.A,{transactions:t,updateTransaction:this.updateTransaction,deleteTransaction:this.deleteTransaction})}},{key:"getBulkSaveCard",value:function(){var t=this.state,e=t.selectedAccount,a=t.accounts,n=t.transactions;if(!E.isEmpty(n))return m.createElement("div",{className:"p-3 shadow-lg"},m.createElement("div",{className:"mb-3"},m.createElement("select",{className:"form-select",value:e,onChange:this.handleAccountChange},m.createElement("option",{value:""},"Select Account"),a.map((function(t,e){return m.createElement("option",{key:e,value:t._id},t.name)})))),m.createElement("div",null,m.createElement("button",{className:"btn btn-primary",disabled:E.isEmpty(e),onClick:this.bulkSave},"Bulk Save")))}},{key:"render",value:function(){return m.createElement("div",{className:"mb-3"},this.getUploadCard(),this.showTransactions(),this.getBulkSaveCard())}},{key:"componentDidMount",value:function(){this.getAccounts()}}])}(m.Component)},8573:(t,e,a)=>{a.d(e,{A:()=>c});var n=a(1967);const c={getAll:function(){return n.A.get("/api/v1/accounts")},upsert:function(t){return n.A.post("/api/v1/account",t)},delete:function(t){return n.A.delete("/api/v1/account/".concat(t))}}}}]);